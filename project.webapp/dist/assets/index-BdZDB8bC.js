import{j as e,f as ve,u as be,a as te,h as oe,b as _e,c as We,d as Ze,C as Je,S as qe,e as he,g as Ce,O as Ye,i as Xe,k as et,A as tt}from"./components-Bg1OXXY_.js";import{r as u,u as ie,R as st,a as Re,b as at,B as rt,c as Ae,d as W,N as Ee}from"./router-cMghrlxF.js";import{a as nt}from"./vendor-DavUf6mE.js";import{d as ot,h as lt,U as ce,i as me,E as le,L as re,D as J,R as De,j as it,k as Pe,l as Le,S as ct,H as Oe,m as $e,A as dt,n as ut,o as mt,p as xe,a as Me,F as fe,q as ye,c as gt,r as ht,Z as Ne,s as Ue,b as xt}from"./ui-CX2R78V6.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))l(g);new MutationObserver(g=>{for(const f of g)if(f.type==="childList")for(const k of f.addedNodes)k.tagName==="LINK"&&k.rel==="modulepreload"&&l(k)}).observe(document,{childList:!0,subtree:!0});function m(g){const f={};return g.integrity&&(f.integrity=g.integrity),g.referrerPolicy&&(f.referrerPolicy=g.referrerPolicy),g.crossOrigin==="use-credentials"?f.credentials="include":g.crossOrigin==="anonymous"?f.credentials="omit":f.credentials="same-origin",f}function l(g){if(g.ep)return;g.ep=!0;const f=m(g);fetch(g.href,f)}})();var pe={},Fe;function pt(){if(Fe)return pe;Fe=1;var a=nt();return pe.createRoot=a.createRoot,pe.hydrateRoot=a.hydrateRoot,pe}var ft=pt();const ge=({error:a,onClose:n,autoClose:m=!0,autoCloseDelay:l=5e3,type:g="error"})=>{const[f,k]=u.useState(!1);if(u.useEffect(()=>{if(a){if(console.log("🔔 [ErrorNotification] Error received:",a),k(!0),m){const $=setTimeout(()=>{console.log("🔔 [ErrorNotification] Auto-closing notification"),k(!1),setTimeout(n,300)},l);return()=>clearTimeout($)}}else console.log("🔔 [ErrorNotification] No error, hiding notification"),k(!1)},[a,m,l,n]),!a)return null;const A={error:{container:"bg-red-50 border-red-200",icon:"text-red-500",title:"text-red-800",text:"text-red-700",closeButton:"text-red-400 hover:text-red-600",progressBg:"bg-red-200",progressBar:"bg-red-500",titleText:"Authentication Error"},warning:{container:"bg-yellow-50 border-yellow-200",icon:"text-yellow-500",title:"text-yellow-800",text:"text-yellow-700",closeButton:"text-yellow-400 hover:text-yellow-600",progressBg:"bg-yellow-200",progressBar:"bg-yellow-500",titleText:"Warning"},info:{container:"bg-blue-50 border-blue-200",icon:"text-blue-500",title:"text-blue-800",text:"text-blue-700",closeButton:"text-blue-400 hover:text-blue-600",progressBg:"bg-blue-200",progressBar:"bg-blue-500",titleText:"Information"}}[g];return e.jsx("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full",children:e.jsx("div",{className:`transform transition-all duration-300 ease-in-out ${f?"translate-x-0 opacity-100 scale-100":"translate-x-full opacity-0 scale-95"}`,children:e.jsxs("div",{className:`border rounded-lg shadow-lg p-4 relative ${A.container}`,children:[e.jsx("button",{onClick:()=>{k(!1),setTimeout(n,300)},className:`absolute top-2 right-2 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 rounded-full p-1 ${A.closeButton}`,"aria-label":"Close notification",children:e.jsx(ot,{className:"w-4 h-4"})}),e.jsxs("div",{className:"flex items-start gap-3 pr-6",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(lt,{className:`w-5 h-5 ${A.icon}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`text-sm font-semibold mb-1 ${A.title}`,children:A.titleText}),e.jsx("p",{className:`text-sm leading-relaxed ${A.text}`,children:a})]})]}),m&&e.jsx("div",{className:`mt-3 h-1 rounded-full overflow-hidden ${A.progressBg}`,children:e.jsx("div",{className:`h-full rounded-full transition-all duration-300 ease-linear ${A.progressBar}`,style:{width:f?"0%":"100%",transitionDuration:`${l}ms`}})})]})})})},Se=()=>{const a=u.useCallback((h,A)=>{const $=h.target,E=$.value,D=ve(E);return D!==E?($.value=D,A(D),$.dispatchEvent(new Event("input",{bubbles:!0})),$.dispatchEvent(new Event("change",{bubbles:!0})),D):(A(E),E)},[]),n=u.useCallback((h,A)=>{h.preventDefault();const $=h.clipboardData.getData("text"),E=ve($),D=h.target;return D.value=E,A(E),D.dispatchEvent(new Event("input",{bubbles:!0})),E},[]),m=u.useCallback(h=>h.key==="Backspace"||h.key==="Delete"||h.key==="ArrowLeft"||h.key==="ArrowRight"||h.key==="ArrowUp"||h.key==="ArrowDown"||h.key==="Tab"||h.key==="Enter"||h.key==="Escape"||h.key==="Home"||h.key==="End"||h.key==="PageUp"||h.key==="PageDown"||h.key==="Shift"||h.key==="Control"||h.key==="Alt"||h.key==="Meta"?!0:(h.ctrlKey||h.metaKey||h.altKey)&&(h.key==="."||h.key===";"||h.key==="=")||h.key.length>1&&(h.key.includes("Emoji")||h.key.includes("emoji"))?(h.preventDefault(),!1):!0,[]),l=u.useCallback(h=>(h.preventDefault(),!1),[]),g=u.useCallback(h=>(h.preventDefault(),!1),[]),f=u.useCallback(h=>(h.preventDefault(),!1),[]),k=u.useCallback((h,A)=>{const $=h.target,E=$.value,D=ve(E);return A(D),D!==E&&($.value=D,$.dispatchEvent(new Event("input",{bubbles:!0})),$.dispatchEvent(new Event("change",{bubbles:!0}))),D},[]);return{handleInputChange:a,handleInputChangeAggressive:k,handlePaste:n,handleKeyDown:m,handleCompositionStart:l,handleCompositionUpdate:g,handleCompositionEnd:f}},Q={localPart:{minLength:1,maxLength:64,allowedChars:/^[a-zA-Z0-9._%+-]+$/,startEndRules:/^[a-zA-Z0-9].*[a-zA-Z0-9]$/,consecutiveDots:/\.{2,}/,consecutiveSpecial:/[._%+-]{2,}/},domain:{minLength:2,maxLength:63,allowedChars:/^[a-zA-Z0-9.-]+$/,startEndRules:/^[a-zA-Z0-9].*[a-zA-Z0-9]$/,consecutiveDots:/\.{2,}/,consecutiveHyphens:/-{2,}/,tldMinLength:2,tldMaxLength:10},overall:{maxLength:254}},Qe=a=>{const n=[],m=[];if(!a||typeof a!="string")return{isValid:!1,errors:["Email address is required"]};a.length>Q.overall.maxLength&&n.push(`Email address is too long (maximum ${Q.overall.maxLength} characters)`);const l=(a.match(/@/g)||[]).length;if(l===0?n.push("Email address must contain an @ symbol"):l>1&&n.push("Email address can only contain one @ symbol"),l!==1)return{isValid:!1,errors:n,suggestions:m};const[g,f]=a.split("@");return!g||g.length===0?n.push("Email address must have a local part (before @)"):bt(g,n,m),!f||f.length===0?n.push("Email address must have a domain part (after @)"):wt(f,n,m),{isValid:n.length===0,errors:n,suggestions:m.length>0?m:void 0}},Y=a=>a.toLowerCase().endsWith("@gmail.com")?yt(a):Qe(a),yt=a=>{const n=[],m=[];if(!a||typeof a!="string")return{isValid:!1,errors:["Email address is required"]};const l=a.split("@")[0];l.length<6&&n.push("Gmail local part must be at least 6 characters long"),l.length>30&&n.push("Gmail local part cannot exceed 30 characters"),(l.startsWith(".")||l.endsWith("."))&&n.push("Gmail local part must start and end with a letter or number"),/\.{2,}/.test(l)&&n.push("Gmail local part cannot contain consecutive dots");const g=Qe(a);return n.push(...g.errors),{isValid:n.length===0,errors:n,suggestions:m.length>0?m:void 0}},bt=(a,n,m)=>{a.length<Q.localPart.minLength&&n.push(`Local part must be at least ${Q.localPart.minLength} characters long`),a.length>Q.localPart.maxLength&&n.push(`Local part cannot exceed ${Q.localPart.maxLength} characters`),Q.localPart.allowedChars.test(a)||(n.push("Local part can only contain letters, numbers, and the following characters: . _ % + -"),m.push("Remove any special characters that are not allowed")),Q.localPart.startEndRules.test(a)||(n.push("Local part must start and end with a letter or number"),m.push("Ensure the local part starts and ends with a letter or number")),Q.localPart.consecutiveDots.test(a)&&(n.push("Local part cannot contain consecutive dots"),m.push("Remove consecutive dots from the local part")),Q.localPart.consecutiveSpecial.test(a)&&(n.push("Local part cannot contain consecutive special characters"),m.push("Remove consecutive special characters from the local part")),(a.toLowerCase()==="gmail"||a.toLowerCase()==="google")&&(n.push("This local part is not allowed by Gmail"),m.push("Choose a different local part for your email address")),["admin","administrator","postmaster","abuse","webmaster","support","info"].includes(a.toLowerCase())&&m.push("This local part might be reserved. Consider using a different one.")},wt=(a,n,m)=>{a.length<Q.domain.minLength&&n.push(`Domain must be at least ${Q.domain.minLength} characters long`),a.length>Q.domain.maxLength&&n.push(`Domain cannot exceed ${Q.domain.maxLength} characters`),Q.domain.allowedChars.test(a)||(n.push("Domain can only contain letters, numbers, dots, and hyphens"),m.push("Remove any special characters that are not allowed in the domain")),Q.domain.startEndRules.test(a)||(n.push("Domain must start and end with a letter or number"),m.push("Ensure the domain starts and ends with a letter or number")),Q.domain.consecutiveDots.test(a)&&(n.push("Domain cannot contain consecutive dots"),m.push("Remove consecutive dots from the domain")),Q.domain.consecutiveHyphens.test(a)&&(n.push("Domain cannot contain consecutive hyphens"),m.push("Remove consecutive hyphens from the domain"));const l=a.split(".");if(l.length<2)n.push("Domain must have at least one dot (e.g., .com, .org)");else{const g=l[l.length-1];g.length<Q.domain.tldMinLength&&n.push(`Top-level domain must be at least ${Q.domain.tldMinLength} characters long`),g.length>Q.domain.tldMaxLength&&n.push(`Top-level domain cannot exceed ${Q.domain.tldMaxLength} characters`),/^[a-zA-Z]+$/.test(g)||(n.push("Top-level domain can only contain letters"),m.push("Ensure the top-level domain contains only letters (e.g., .com, .org)"))}(a.toLowerCase()==="localhost"||a.toLowerCase()==="test")&&(n.push("This domain is not valid for email addresses"),m.push("Use a real domain name for your email address"))},se=(a,n)=>{if(n.isValid)return"";const m=n.errors[0];return{"Email address is required":"Please enter your email address","Email address must contain an @ symbol":"Please enter a valid email address","Email address can only contain one @ symbol":"Please enter a valid email address","Email address must have a local part (before @)":"Please enter a valid email address","Email address must have a domain part (after @)":"Please enter a valid email address","Local part must be at least 1 characters long":"Please enter a valid email address","Local part cannot exceed 64 characters":"Please enter a valid email address","Local part can only contain letters, numbers, and the following characters: . _ % + -":"Please enter a valid email address","Local part must start and end with a letter or number":"Please enter a valid email address","Local part cannot contain consecutive dots":"Please enter a valid email address","Local part cannot contain consecutive special characters":"Please enter a valid email address","Domain must be at least 2 characters long":"Please enter a valid email address","Domain cannot exceed 63 characters":"Please enter a valid email address","Domain can only contain letters, numbers, dots, and hyphens":"Please enter a valid email address","Domain must start and end with a letter or number":"Please enter a valid email address","Domain cannot contain consecutive dots":"Please enter a valid email address","Domain cannot contain consecutive hyphens":"Please enter a valid email address","Domain must have at least one dot (e.g., .com, .org)":"Please enter a valid email address","Top-level domain must be at least 2 characters long":"Please enter a valid email address","Top-level domain cannot exceed 10 characters":"Please enter a valid email address","Top-level domain can only contain letters":"Please enter a valid email address","Email address is too long (maximum 254 characters)":"Please enter a valid email address","Gmail local part must be at least 6 characters long":"Gmail addresses must be at least 6 characters before @","Gmail local part cannot exceed 30 characters":"Gmail addresses cannot exceed 30 characters before @","Gmail local part must start and end with a letter or number":"Gmail addresses must start and end with a letter or number"}[m]||"Please enter a valid email address"},de=a=>{if(!a)return"";let n=a.trim().toLowerCase();return n=n.replace(/\s+/g,""),n},vt=()=>{const[a,n]=u.useState({email:"",password:""}),[m,l]=u.useState(!1),[g,f]=u.useState(!1),[k,h]=u.useState({}),[A,$]=u.useState(null),E=ie(),{login:D,error:F,clearError:N,isAuthenticated:x,user:L}=be(),{handleInputChangeAggressive:H,handlePaste:X,handleKeyDown:B}=Se();u.useEffect(()=>{F&&console.log("🔍 [Login] Error state changed:",F)},[F]),u.useEffect(()=>{const b=async()=>{if(x&&L){console.log("[Login] User is authenticated via AuthContext, redirecting to overview..."),E("/overview",{replace:!0});return}if(te.isAuthenticated()){console.log("[Login] User is authenticated via authService, redirecting to overview..."),E("/overview",{replace:!0});return}};b();const i=setInterval(b,100);return()=>{clearInterval(i),$(null),f(!1)}},[E,x,L]);const _=(b,i)=>{const c={...k};if(b==="email")if(!i.trim())c.email="Please enter your email address";else{const v=Y(i);v.isValid?delete c.email:c.email=se(i,v)}else b==="password"&&(i.trim()?delete c.password:c.password="Please enter your password");return h(c),!c[b]},V=b=>{const{name:i,value:c}=b.target;_(i,c)},Z=async b=>{b.preventDefault();try{h({}),$(null);const i={};if(!a.email.trim())i.email="Please enter your email address";else try{const c=Y(a.email);(!c||!c.isValid)&&(i.email=se(a.email,c))}catch(c){console.error("[Login] Email validation error:",c),i.email="Please enter a valid email address"}if(a.password.trim()?a.password&&a.password.length>0&&(a.password.length<8?i.password="Password must be at least 8 characters long":/[A-Z]/.test(a.password)?/[a-z]/.test(a.password)?/\d/.test(a.password)?/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(a.password)||(i.password="Password must contain at least one special character"):i.password="Password must contain at least one number":i.password="Password must contain at least one lowercase letter":i.password="Password must contain at least one uppercase letter"):i.password="Please enter your password",Object.keys(i).length>0){h(i);return}f(!0),N();try{console.log("[Login] Attempting local login with:",{email:a.email,passwordLength:a.password?a.password.length:0}),await D("local",{email:a.email,password:a.password}),console.log("[Login] Local login successful")}catch(c){console.error("[Login] Local login error:",c);let v="Invalid credentials entered please verify and try logging in";c&&typeof c=="object"&&(c.message&&typeof c.message=="string"?(c.message.includes("Network")||c.message.includes("fetch")||c.message.includes("Failed to fetch"))&&(v="Network error. Please check your connection and try again."):c.error&&typeof c.error=="string"&&(c.error.includes("Network")||c.error.includes("connection"))&&(v="Network error. Please check your connection and try again.")),console.log("[Login] Setting authentication error message:",v),console.log("[Login] Error object details:",{hasError:!!c,errorType:typeof c,errorMessage:c?.message,errorError:c?.error,stack:c?.stack}),$(typeof v=="string"?v:"Invalid credentials entered please verify and try logging in")}finally{f(!1)}}catch(i){console.error("[Login] Unexpected error during form submission:",i),$("An unexpected error occurred. Please try again."),f(!1)}},G=async()=>{N(),$(null),f(!0);try{const b=D("google"),i=new Promise((c,v)=>setTimeout(()=>v(new Error("Google sign-in timed out")),15e3));await Promise.race([b,i]),console.log("[Login] Google sign-in successful"),await new Promise(c=>setTimeout(c,300)),console.log("[Login] Authentication state after Google login:",{isAuthenticated:te.isAuthenticated(),hasToken:!!te.getAccessToken(),user:await te.getCurrentUser()}),console.log("[Login] Google authentication completed, waiting for redirect...")}catch(b){console.error("[Login] Google sign-in error:",b);let i="Google sign-in failed. Please try again.";if(b&&typeof b=="object"&&b.message&&typeof b.message=="string")if(b.message.includes("cancelled")||b.message.includes("Cancelled")){console.log("[Login] Google sign-in cancelled by user"),f(!1);return}else b.message.includes("timed out")||b.message.includes("Timed out")?i="Google sign-in timed out. Please try again.":b.message.includes("Network")||b.message.includes("fetch")?i="Network error. Please check your connection and try again.":i=b.message;$(i)}finally{f(!1)}},U=async()=>{N(),f(!0);try{console.log("[Login] Starting Microsoft sign-in..."),console.log("[Login] Environment variables:",{clientId:"8d042e34-5a5f-40f5-a019-ee56de49b64e",tenantId:"c16b04b5-b78c-4cce-b3f8-93686f221d09",redirectUri:"http://localhost:5173/auth/callback"}),await D("microsoft"),console.log("[Login] Microsoft sign-in successful"),await new Promise(b=>setTimeout(b,500)),console.log("[Login] Authentication state after login:",{isAuthenticated:te.isAuthenticated(),hasToken:!!te.getAccessToken(),user:await te.getCurrentUser()}),console.log("[Login] Microsoft authentication completed, waiting for redirect...")}catch(b){console.error("[Login] Microsoft sign-in error:",b)}finally{f(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gray-200/30"}),e.jsx("div",{className:"absolute inset-0 bg-gray-300/20"}),e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-gray-400/40 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-[500px] h-[500px] bg-gray-500/40 rounded-full blur-3xl translate-x-1/2 translate-y-1/2 animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-80 h-80 bg-gray-600/35 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute top-1/4 right-1/4 w-32 h-32 bg-gradient-to-br from-cyan-300/30 to-blue-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute bottom-1/4 left-1/4 w-24 h-24 bg-gradient-to-br from-purple-300/30 to-pink-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"1.5s"}}),e.jsx("div",{className:"absolute top-3/4 left-1/3 w-20 h-20 bg-gradient-to-br from-indigo-300/30 to-purple-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"2.5s"}}),e.jsx("div",{className:"absolute top-1/3 left-1/6 w-16 h-16 bg-gradient-to-br from-indigo-400/25 to-purple-400/25 rotate-45 blur-xl animate-spin",style:{animationDuration:"8s"}}),e.jsx("div",{className:"absolute bottom-1/3 right-1/6 w-20 h-20 bg-gradient-to-br from-blue-400/25 to-cyan-400/25 rotate-12 blur-xl animate-spin",style:{animationDuration:"12s",animationDirection:"reverse"}}),e.jsx("div",{className:"absolute top-1/6 right-1/3 w-12 h-12 bg-gradient-to-br from-pink-400/25 to-purple-400/25 rotate-30 blur-lg animate-spin",style:{animationDuration:"6s"}}),e.jsx("div",{className:"absolute top-1/5 left-1/5 w-8 h-8 bg-gradient-to-br from-cyan-400/20 to-blue-400/20 rounded-full blur-md animate-ping",style:{animationDelay:"0s"}}),e.jsx("div",{className:"absolute top-2/5 right-1/5 w-6 h-6 bg-gradient-to-br from-purple-400/20 to-pink-400/20 rounded-full blur-md animate-ping",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute bottom-1/5 left-2/5 w-10 h-10 bg-gradient-to-br from-indigo-400/20 to-blue-400/20 rounded-full blur-md animate-ping",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute bottom-2/5 right-2/5 w-7 h-7 bg-gradient-to-br from-cyan-400/20 to-indigo-400/20 rounded-full blur-md animate-ping",style:{animationDelay:"3s"}}),e.jsx("div",{className:"absolute top-0 left-1/2 w-64 h-64 bg-gradient-to-br from-blue-300/15 to-indigo-300/15 rounded-full blur-2xl animate-pulse",style:{animationDuration:"4s"}}),e.jsx("div",{className:"absolute bottom-0 left-1/4 w-48 h-48 bg-gradient-to-br from-purple-300/15 to-pink-300/15 rounded-full blur-2xl animate-pulse",style:{animationDuration:"6s",animationDelay:"1s"}}),e.jsxs("div",{className:"w-full max-w-lg mx-auto p-8 bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 relative z-10 bg-gradient-to-br from-white/95 via-white/90 to-white/95",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"w-24 h-24 bg-blue-600 rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(ce,{className:"w-12 h-12 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-black mb-3",children:"Welcome to kabini.ai"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Sign in to your account to continue"})]}),e.jsxs("form",{onSubmit:Z,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-3",children:["Email ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:a.email,onChange:b=>H(b,i=>{const c=de(i);n(j=>({...j,email:c}));const v=Y(c);v.isValid?h(j=>({...j,email:void 0})):h(j=>({...j,email:se(c,v)}))}),onPaste:b=>X(b,i=>{const c=de(i);n(j=>({...j,email:c}));const v=Y(c);v.isValid?h(j=>({...j,email:void 0})):h(j=>({...j,email:se(c,v)}))}),onKeyDown:B,onCompositionStart:b=>b.preventDefault(),onCompositionUpdate:b=>b.preventDefault(),onCompositionEnd:b=>b.preventDefault(),onBlur:V,required:!0,inputMode:"email",autoComplete:"email",className:`w-full px-4 py-4 border-2 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all ${k.email?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`,placeholder:"Enter your email address *"}),k.email&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),k.email]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-3",children:["Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:m?"text":"password",name:"password",value:a.password,onChange:b=>H(b,i=>{n(c=>({...c,password:i})),i.trim()?h(c=>({...c,password:void 0})):h(c=>({...c,password:"Please enter your password"}))}),onPaste:b=>X(b,i=>{n(c=>({...c,password:i})),i.trim()?h(c=>({...c,password:void 0})):h(c=>({...c,password:"Please enter your password"}))}),onKeyDown:B,onCompositionStart:b=>b.preventDefault(),onCompositionUpdate:b=>b.preventDefault(),onCompositionEnd:b=>b.preventDefault(),required:!0,placeholder:"Enter your password *",className:`w-full px-4 py-4 border-2 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all ${k.password?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>l(!m),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors focus:outline-none",tabIndex:-1,children:m?e.jsx(me,{className:"w-5 h-5"}):e.jsx(le,{className:"w-5 h-5"})})]}),k.password&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),k.password]})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-600 text-white font-bold py-4 px-6 rounded-xl hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",disabled:g,children:g?e.jsx(re,{className:"w-5 h-5 animate-spin"}):"Sign In"})]}),e.jsxs("div",{className:"mt-6 text-center space-y-2",children:[e.jsx("div",{children:e.jsx("span",{onClick:()=>E("/forgot-password"),className:"text-sm text-black hover:text-gray-700 underline hover:no-underline transition-colors cursor-pointer",children:"Forgot your password?"})}),e.jsx("div",{children:e.jsx("span",{onClick:()=>E("/signup"),className:"text-sm text-black hover:text-gray-700 underline hover:no-underline transition-colors cursor-pointer",children:"Don't have an account? Sign up"})})]}),e.jsxs("div",{className:"mt-10 space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Or continue with"})})]}),e.jsx("button",{onClick:G,disabled:g,className:"w-full bg-white border-2 border-grey-300 text-black font-semibold py-4 px-6 rounded-xl hover:bg-grey-50 hover:border-grey-400 hover:text-gray-700 transition-all flex items-center justify-center gap-4 disabled:opacity-50 disabled:cursor-not-allowed",children:g?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-6 h-6 animate-spin"}),e.jsx("span",{children:"Signing in with Google..."})]}):e.jsxs(e.Fragment,{children:[e.jsx("img",{src:"/google.svg",alt:"Google",className:"w-6 h-6"}),"Sign in with Google"]})}),e.jsxs("button",{onClick:U,disabled:g,className:"w-full bg-white border-2 border-grey-300 text-black font-semibold py-4 px-6 rounded-xl hover:bg-grey-50 hover:border-grey-400 hover:text-gray-700 transition-all flex items-center justify-center gap-4 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx("img",{src:"/microsoft.svg",alt:"Microsoft",className:"w-6 h-6"}),"Sign in with Microsoft"]})]})]}),e.jsx(ge,{error:A||(F&&typeof F=="string"?F:null),onClose:()=>{$(null),N()},autoClose:!0,autoCloseDelay:5e3})]})};function jt(a,n,m){const l=new Blob([a],{type:m}),g=URL.createObjectURL(l),f=document.createElement("a");f.href=g,f.download=n,document.body.appendChild(f),f.click(),document.body.removeChild(f),URL.revokeObjectURL(g)}function Nt({qaItems:a,onExport:n}){const[m,l]=u.useState([]),[g,f]=u.useState([]),[k,h]=u.useState([]),[A,$]=u.useState(new Set),[E,D]=u.useState(new Set),[F,N]=u.useState(0),[x,L]=u.useState({searchTerm:"",dateFilter:"all",specificDate:"",typeFilter:"all",statusFilter:"all",showFilters:!1,groupBy:"date",sortBy:"date",sortOrder:"desc"});u.useEffect(()=>{(async()=>{try{const s=await oe.getHistoryItems();console.log("[History] Loaded items:",s.length,s);const d=s.filter(r=>r&&typeof r=="object"&&r.id&&r.type&&r.name&&r.timestamp);console.log("[History] Valid items:",d.length,d),l(d)}catch(s){console.error("[History] Error loading history items:",s),l([])}})()},[F]),u.useEffect(()=>{(async()=>{console.log("[History] Component mounted, loading initial history items");try{const s=await oe.getHistoryItems();l(s)}catch(s){console.error("[History] Error loading initial history items:",s),l([])}})()},[]),u.useEffect(()=>{a&&a.length>0&&(console.log("[History] qaItems prop changed, syncing with history service"),N(t=>t+1))},[a]),u.useEffect(()=>{const t=r=>{r.key&&r.key.includes("comprehensive_history")&&(console.log("[History] Storage changed, refreshing history"),N(R=>R+1))},s=()=>{console.log("[History] New analysis event received, refreshing history"),N(r=>r+1)};window.addEventListener("new-analysis-created",s),window.addEventListener("storage",t);const d=async()=>{try{const r=await oe.getHistoryItems();r.length!==m.length&&(console.log("[History] Item count changed on focus, refreshing history"),l(r))}catch(r){console.error("[History] Error checking history on focus:",r)}};return window.addEventListener("focus",d),()=>{window.removeEventListener("new-analysis-created",s),window.removeEventListener("storage",t),window.removeEventListener("focus",d)}},[m.length]);const H=u.useMemo(()=>{const t=new Set,s=new Set;return m.forEach(d=>{d.type&&t.add(d.type),d.status&&s.add(d.status)}),{types:Array.from(t).filter(Boolean).sort(),statuses:Array.from(s).filter(Boolean).sort()}},[m,F]);u.useEffect(()=>{console.log("[History] History items updated:",m.length,"items"),console.log("[History] History data:",m);let t=[...m];if(x.searchTerm&&(t=t.filter(s=>s.name.toLowerCase().includes(x.searchTerm.toLowerCase())||s.description?.toLowerCase().includes(x.searchTerm.toLowerCase())||s.type==="qa"&&s.sessionData.qaData.some(d=>d.question.toLowerCase().includes(x.searchTerm.toLowerCase())||d.answer.toLowerCase().includes(x.searchTerm.toLowerCase()))||s.type==="ai-visibility"&&s.company.toLowerCase().includes(x.searchTerm.toLowerCase()))),x.dateFilter!=="all"){const s=new Date,d=new Date;switch(x.dateFilter){case"today":d.setHours(0,0,0,0);break;case"week":d.setDate(s.getDate()-7);break;case"month":d.setMonth(s.getMonth()-1);break;case"year":d.setFullYear(s.getFullYear()-1);break;case"specific":if(x.specificDate){const r=new Date(x.specificDate);r.setHours(0,0,0,0);const R=new Date(x.specificDate);R.setHours(23,59,59,999),t=t.filter(q=>{const M=new Date(q.timestamp);return M>=r&&M<=R})}break}x.dateFilter!=="specific"&&(t=t.filter(r=>new Date(r.timestamp)>=d))}x.typeFilter!=="all"&&(t=t.filter(s=>s.type===x.typeFilter)),x.statusFilter!=="all"&&(t=t.filter(s=>s.status===x.statusFilter)),t.sort((s,d)=>{let r,R;switch(x.sortBy){case"date":r=new Date(s.timestamp).getTime(),R=new Date(d.timestamp).getTime();break;case"name":r=s.name.toLowerCase(),R=d.name.toLowerCase();break;case"type":r=s.type,R=d.type;break;case"status":r=s.status,R=d.status;break;default:r=new Date(s.timestamp).getTime(),R=new Date(d.timestamp).getTime()}return x.sortOrder==="asc"?r>R?1:-1:r<R?1:-1}),console.log("[History] Filtered items:",t.length,"items"),f(t)},[m,x,F]),u.useEffect(()=>{const t=[],s=new Map;g.forEach(d=>{let r="";switch(x.groupBy){case"date":const R=new Date(d.timestamp);r=R.toDateString(),R.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"});break;case"type":r=d.type,_(d.type);break;case"status":r=d.status,d.status.charAt(0).toUpperCase()+d.status.slice(1);break}s.has(r)||s.set(r,[]),s.get(r).push(d)}),s.forEach((d,r)=>{let R=r;x.groupBy==="date"?R=new Date(r).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}):x.groupBy==="type"?R=_(r):x.groupBy==="status"&&(R=r.charAt(0).toUpperCase()+r.slice(1)),t.push({groupKey:r,groupTitle:R,groupType:x.groupBy,items:d,totalItems:d.length,dateRange:x.groupBy==="date"?r:void 0})}),t.sort((d,r)=>x.groupBy==="date"?new Date(r.groupKey).getTime()-new Date(d.groupKey).getTime():d.groupTitle.localeCompare(r.groupTitle)),h(t)},[g,x.groupBy,F]);const X=t=>{const s=new Set(A);s.has(t)?s.delete(t):s.add(t),$(s)},B=t=>{const s=new Set(E);s.has(t)?s.delete(t):s.add(t),D(s)},_=t=>{if(!t)return"Unknown";switch(t){case"qa":return"Q&A Sessions";case"ai-visibility":return"AI Visibility Analysis";case"content-analysis":return"Content Analysis";case"structure-analysis":return"Structure Analysis";default:return t}},V=t=>{switch(t){case"completed":return"text-green-600 bg-green-100";case"in-progress":return"text-yellow-600 bg-yellow-100";case"failed":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},Z=t=>{try{if(!t||!t.type)return console.error("[History] Invalid item:",t),e.jsx("div",{className:"text-red-500",children:"Invalid item data"});switch(t.type){case"qa":return G(t);case"ai-visibility":return U(t);case"content-analysis":return b(t);case"structure-analysis":return i(t);default:return e.jsxs("div",{className:"text-orange-500",children:["Unknown item type: ",t.type]})}}catch(s){return console.error("[History] Error rendering item:",s,t),e.jsxs("div",{className:"text-red-500",children:["Error rendering item: ",s.message]})}},G=t=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx(fe,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-black",children:t.name}),e.jsx("div",{className:"text-xs text-grey-600",children:ee(t.timestamp)}),e.jsxs("div",{className:"text-xs text-black",children:[t.sessionData.qaData.length," Q&A pairs"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${V(t.status)}`,children:t.status}),e.jsx("input",{type:"checkbox",checked:E.has(t.id),onChange:()=>B(t.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"space-y-3",children:[t.sessionData.qaData.slice(0,3).map((s,d)=>e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{className:"font-semibold text-gray-900 mb-2",children:["Q",d+1,": ",s.question]}),s.answer&&e.jsxs("div",{className:"text-sm text-gray-700 mb-2",children:[s.answer.substring(0,100),"..."]}),e.jsxs("div",{className:"flex gap-2 text-xs text-gray-500",children:[e.jsxs("span",{children:["Accuracy: ",s.accuracy||"N/A"]}),e.jsxs("span",{children:["Sentiment: ",s.sentiment||"N/A"]}),e.jsxs("span",{children:["Cost: $",(s.cost||0).toFixed(4)]})]})]},d)),t.sessionData.qaData.length>3&&e.jsxs("div",{className:"text-center text-sm text-gray-500",children:["+",t.sessionData.qaData.length-3," more Q&A pairs"]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>v(t.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"JSON"]}),e.jsxs("button",{onClick:()=>j(t.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"CSV"]}),e.jsxs("button",{onClick:()=>T(t.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),"Delete"]})]})]}),U=t=>!t.analysis||!t.analysis.competitors?e.jsxs("div",{className:"border border-red-200 rounded-lg p-4 bg-red-50",children:[e.jsx("div",{className:"text-red-600",children:"Invalid AI Visibility data structure"}),e.jsx("div",{className:"text-xs text-red-500 mt-2",children:"Missing analysis or competitors data"})]}):e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center",children:e.jsx(le,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-black",children:t.name}),e.jsx("div",{className:"text-xs text-grey-600",children:ee(t.timestamp)}),e.jsxs("div",{className:"text-xs text-purple-600",children:[t.analysis.competitors?.length||0," competitors analyzed"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${V(t.status)}`,children:t.status}),e.jsx("input",{type:"checkbox",checked:E.has(t.id),onChange:()=>B(t.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{className:"font-semibold text-gray-900 mb-2",children:["Company: ",t.company]}),t.industry&&e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Industry: ",t.industry]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[e.jsxs("div",{children:["Top Competitor: ",t.analysis.summary?.topCompetitor||"N/A"]}),e.jsxs("div",{children:["Avg Score: ",t.analysis.summary?.averageVisibilityScore?.toFixed(1)||"N/A"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[t.analysis.competitors.slice(0,3).map((s,d)=>e.jsxs("div",{className:"bg-white rounded-lg p-2 border border-gray-200",children:[e.jsx("div",{className:"font-medium text-sm",children:s.name}),e.jsxs("div",{className:"text-xs text-gray-600",children:["Avg Score: ",s.visibilityScores?.average?.toFixed(1)||"N/A"]})]},d)),t.analysis.competitors.length>3&&e.jsxs("div",{className:"text-center text-sm text-gray-500",children:["+",t.analysis.competitors.length-3," more competitors"]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>v(t.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"JSON"]}),e.jsxs("button",{onClick:()=>j(t.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"CSV"]}),e.jsxs("button",{onClick:()=>T(t.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),"Delete"]})]})]}),b=t=>t.analysis?e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-green-500 rounded-full flex items-center justify-center",children:e.jsx(Me,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-black",children:t.name}),e.jsx("div",{className:"text-xs text-grey-600",children:ee(t.timestamp)}),e.jsxs("div",{className:"text-xs text-green-600",children:["SEO Score: ",t.analysis?.seoScore||"N/A","/100"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${V(t.status)}`,children:t.status}),e.jsx("input",{type:"checkbox",checked:E.has(t.id),onChange:()=>B(t.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"SEO Score"}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:t.analysis?.seoScore||"N/A"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"Readability"}),e.jsx("div",{className:"text-2xl font-bold text-black",children:t.analysis?.readabilityScore||"N/A"})]})]}),t.analysis?.suggestions?.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:"Suggestions"}),e.jsxs("div",{className:"space-y-1",children:[t.analysis.suggestions.slice(0,3).map((s,d)=>e.jsxs("div",{className:"text-xs text-gray-600",children:["• ",s.description]},d)),t.analysis.suggestions.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",t.analysis.suggestions.length-3," more suggestions"]})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>v(t.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"JSON"]}),e.jsxs("button",{onClick:()=>j(t.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"CSV"]}),e.jsxs("button",{onClick:()=>T(t.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),"Delete"]})]})]}):e.jsxs("div",{className:"border border-red-200 rounded-lg p-4 bg-red-50",children:[e.jsx("div",{className:"text-red-600",children:"Invalid Content Analysis data structure"}),e.jsx("div",{className:"text-xs text-red-500 mt-2",children:"Missing analysis data"})]}),i=t=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx(mt,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{children:[e.jsx("div",{className:"font-bold text-black",children:t.name}),e.jsx("div",{className:"text-xs text-grey-600",children:ee(t.timestamp)}),e.jsxs("div",{className:"text-xs text-orange-600",children:[t.analysis.suggestions?.length||0," suggestions"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${V(t.status)}`,children:t.status}),e.jsx("input",{type:"checkbox",checked:E.has(t.id),onChange:()=>B(t.id),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-gray-200",children:[t.analysis.geoScoreTotal!==void 0||t.analysis.contentQualityScoreTotal!==void 0?e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm mb-4",children:[t.analysis.geoScoreTotal!==void 0&&e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"GEO Score"}),e.jsxs("div",{className:"text-xl font-bold text-red-600",children:[t.analysis.geoScoreTotal,"/100"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"AI visibility & search optimization"})]}),t.analysis.contentQualityScoreTotal!==void 0&&e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:"Content Quality"}),e.jsxs("div",{className:"text-xl font-bold text-orange-600",children:[t.analysis.contentQualityScoreTotal,"/100"]}),e.jsx("div",{className:"text-xs text-gray-600",children:"Human/editorial score"})]})]}):null,e.jsxs("div",{className:"grid grid-cols-4 gap-2 text-xs text-gray-600 mb-3",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.analysis.wordCount||t.analysis.metadata?.wordCount||0}),e.jsx("div",{children:"Words"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.analysis.readingTime||t.analysis.metadata?.readingTime||1}),e.jsx("div",{children:"Min Read"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.analysis.suggestionsCount||t.analysis.suggestions?.length||0}),e.jsx("div",{children:"Suggestions"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:(t.analysis.language||t.analysis.metadata?.language||"en").toUpperCase()}),e.jsx("div",{children:"Language"})]})]}),t.analysis.suggestions&&t.analysis.suggestions.length>0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"font-semibold text-gray-900 mb-2",children:["Top Suggestions (",t.analysis.suggestions.length," total)"]}),e.jsxs("div",{className:"space-y-2",children:[t.analysis.suggestions.slice(0,5).map((s,d)=>e.jsxs("div",{className:"bg-gray-50 rounded p-2 border-l-4 border-blue-500",children:[e.jsxs("div",{className:"text-xs text-gray-600 font-medium mb-1",children:[s.type.charAt(0).toUpperCase()+s.type.slice(1)," • ",s.priority]}),e.jsx("div",{className:"text-xs text-gray-800",children:s.description}),s.impact&&e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Impact: ",s.impact]})]},d)),t.analysis.suggestions.length>5&&e.jsxs("div",{className:"text-center text-xs text-gray-500 bg-gray-100 rounded p-2",children:["+",t.analysis.suggestions.length-5," more suggestions available"]})]})]})]}),e.jsxs("div",{className:"flex gap-2 mt-4",children:[e.jsxs("button",{onClick:()=>v(t.id),className:"bg-blue-600 text-white px-3 py-1 rounded text-sm hover:bg-blue-700 transition flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"JSON"]}),e.jsxs("button",{onClick:()=>j(t.id),className:"bg-green-600 text-white px-3 py-1 rounded text-sm hover:bg-green-700 transition flex items-center gap-1",children:[e.jsx(J,{className:"h-3 w-3"}),"CSV"]}),e.jsxs("button",{onClick:()=>T(t.id),className:"bg-red-600 text-white px-3 py-1 rounded text-sm hover:bg-red-700 transition flex items-center gap-1",children:[e.jsx(xe,{className:"h-3 w-3"}),"Delete"]})]})]}),c=()=>{const t=E.size>0?g.filter(q=>E.has(q.id)):g;let s="";t.forEach(q=>{switch(q.type){case"qa":const M=q;s+=`
=== Q&A SESSION: ${M.name} ===
`,s+=`Session ID,${M.id}
`,s+=`Timestamp,${new Date(M.timestamp).toISOString()}
`,s+=`Model,${M.sessionData.model}
`,s+=`Total Questions,${M.sessionData.qaData.length}
`,s+=`Total Cost,${M.sessionData.statistics.totalCost}
`,s+=`Average Accuracy,${M.sessionData.statistics.avgAccuracy}%
`,s+=`Blog Content,"${M.sessionData.blogContent.replace(/"/g,'""')}"
`,s+=`
Question,Answer,Accuracy,Sentiment,Geo Score,Citation Likelihood,Input Tokens,Output Tokens,Total Tokens,Cost
`,M.sessionData.qaData.forEach((I,ue)=>{s+=`"${I.question.replace(/"/g,'""')}","${I.answer.replace(/"/g,'""')}",${I.accuracy}%,${I.sentiment},${I.geoScore},${I.citationLikelihood},${I.inputTokens},${I.outputTokens},${I.totalTokens},$${I.cost}
`});break;case"ai-visibility":const P=q;s+=`
=== AI VISIBILITY ANALYSIS: ${P.name} ===
`,s+=`Company,${P.company}
`,s+=`Industry,${P.industry||"N/A"}
`,s+=`Timestamp,${new Date(P.timestamp).toISOString()}
`,s+=`Overall Score,${P.analysis.overallScore}
`,s+=`Content Quality,${P.analysis.contentQuality}
`,s+=`Technical SEO,${P.analysis.technicalSEO}
`,s+=`User Experience,${P.analysis.userExperience}
`,s+=`Competitive Position,${P.analysis.competitivePosition}
`,s+=`
Competitors Found:
`,s+=`Competitor Name,Website,Relevance Score,Strengths,Weaknesses
`,P.analysis.competitors.forEach(I=>{s+=`"${I.name}","${I.website}",${I.relevanceScore},"${I.strengths.join("; ").replace(/"/g,'""')}","${I.weaknesses.join("; ").replace(/"/g,'""')}"
`}),s+=`
Recommendations:
`,s+=`Priority,Recommendation,Impact,Effort
`,P.analysis.recommendations.forEach(I=>{s+=`${I.priority},"${I.recommendation.replace(/"/g,'""')}",${I.impact},${I.effort}
`});break;case"content-analysis":const S=q;s+=`
=== CONTENT ANALYSIS: ${S.name} ===
`,s+=`URL,${S.url||"N/A"}
`,s+=`Timestamp,${new Date(S.timestamp).toISOString()}
`,s+=`SEO Score,${S.analysis.seoScore}
`,s+=`Readability Score,${S.analysis.readabilityScore}
`,s+=`Content Length,${S.analysis.contentLength} words
`,s+=`Keyword Density,${S.analysis.keywordDensity}%
`,s+=`
Analyzed Content:
`,s+=`"${S.content.replace(/"/g,'""')}"
`,s+=`
Suggestions:
`,s+=`Category,Suggestion,Priority
`,S.analysis.suggestions.forEach(I=>{s+=`${I.category},"${I.suggestion.replace(/"/g,'""')}",${I.priority}
`});break;case"structure-analysis":const w=q;s+=`
=== STRUCTURE ANALYSIS: ${w.name} ===
`,s+=`Timestamp,${new Date(w.timestamp).toISOString()}
`,s+=`Original Content Length,${w.originalContent.length} characters
`,s+=`Structured Content Length,${w.structuredContent.length} characters
`,s+=`
Analysis Scores:
`,w.analysis.geoScoreTotal!==void 0&&(s+=`GEO Score,${w.analysis.geoScoreTotal}/100
`),w.analysis.contentQualityScoreTotal!==void 0&&(s+=`Content Quality Score,${w.analysis.contentQualityScoreTotal}/100
`),s+=`
Content Metadata:
`,s+=`Title,${w.analysis.metadata.title}
`,s+=`Description,${w.analysis.metadata.description}
`,s+=`Keywords,"${w.analysis.metadata.keywords.join(", ")}"
`,s+=`Author,${w.analysis.metadata.author}
`,s+=`Publish Date,${w.analysis.metadata.publishDate}
`,s+=`Last Modified,${w.analysis.metadata.lastModified}
`,s+=`Reading Time,${w.analysis.metadata.readingTime} minutes
`,s+=`Word Count,${w.analysis.metadata.wordCount}
`,s+=`Language,${w.analysis.metadata.language}
`,s+=`
Original Content:
`,s+=`"${w.originalContent.replace(/"/g,'""')}"
`,s+=`
Structured Content:
`,s+=`"${w.structuredContent.replace(/"/g,'""')}"
`,s+=`
Structure Suggestions:
`,s+=`Type,Priority,Description,Implementation,Impact
`,w.analysis.suggestions.forEach(I=>{s+=`${I.type},${I.priority},"${I.description.replace(/"/g,'""')}","${I.implementation.replace(/"/g,'""')}","${I.impact.replace(/"/g,'""')}"
`});break;default:s+=`
=== UNKNOWN TYPE: ${q.name} ===
`,s+=`ID,${q.id}
`,s+=`Type,${q.type}
`,s+=`Status,${q.status}
`,s+=`Timestamp,${new Date(q.timestamp).toISOString()}
`,s+=`Description,${q.description||"N/A"}
`}s+=`
`+"=".repeat(80)+`
`});const d=`COMPREHENSIVE HISTORY EXPORT
`,r=`Export Date: ${new Date().toISOString()}
`,R=`Total Items: ${t.length}
`;n(d+r+R+s,"comprehensive-history-detailed.csv","text/csv")},v=t=>{console.log("[History] Downloading item:",t);try{const s=oe.exportHistoryItem(t);s&&s.content?(console.log("[History] Export data:",s),n(s.content,s.filename,s.mimeType)):(console.error("[History] No export data found for item:",t),alert("No data found for this item. It might be sample data or corrupted."))}catch(s){console.error("[History] Error downloading item:",s),alert("Error downloading item. Please try again.")}},j=t=>{console.log("[History] Downloading item as CSV:",t);const d=oe.getHistoryItems().find(q=>q.id===t);if(!d){alert("Item not found!");return}let r="";switch(d.type){case"qa":const q=d;r+=`Q&A Session Export
`,r+=`Session Name,${q.name}
`,r+=`Session ID,${q.id}
`,r+=`Timestamp,${new Date(q.timestamp).toISOString()}
`,r+=`Model,${q.sessionData.model}
`,r+=`Total Questions,${q.sessionData.qaData.length}
`,r+=`Total Cost,${q.sessionData.statistics.totalCost}
`,r+=`Average Accuracy,${q.sessionData.statistics.avgAccuracy}%
`,r+=`Blog Content,"${q.sessionData.blogContent.replace(/"/g,'""')}"

`,r+=`Question,Answer,Accuracy,Sentiment,Geo Score,Citation Likelihood,Input Tokens,Output Tokens,Total Tokens,Cost
`,q.sessionData.qaData.forEach((w,I)=>{r+=`"${w.question.replace(/"/g,'""')}","${w.answer.replace(/"/g,'""')}",${w.accuracy}%,${w.sentiment},${w.geoScore},${w.citationLikelihood},${w.inputTokens},${w.outputTokens},${w.totalTokens},$${w.cost}
`});break;case"ai-visibility":const M=d;r+=`AI Visibility Analysis Export
`,r+=`Analysis Name,${M.name}
`,r+=`Company,${M.company}
`,r+=`Industry,${M.industry||"N/A"}
`,r+=`Timestamp,${new Date(M.timestamp).toISOString()}
`,r+=`Overall Score,${M.analysis.overallScore}
`,r+=`Content Quality,${M.analysis.contentQuality}
`,r+=`Technical SEO,${M.analysis.technicalSEO}
`,r+=`User Experience,${M.analysis.userExperience}
`,r+=`Competitive Position,${M.analysis.competitivePosition}

`,r+=`Competitors:
`,r+=`Name,Website,Relevance Score,Strengths,Weaknesses
`,M.analysis.competitors.forEach(w=>{r+=`"${w.name}","${w.website}",${w.relevanceScore},"${w.strengths.join("; ").replace(/"/g,'""')}","${w.weaknesses.join("; ").replace(/"/g,'""')}"
`}),r+=`
Recommendations:
`,r+=`Priority,Recommendation,Impact,Effort
`,M.analysis.recommendations.forEach(w=>{r+=`${w.priority},"${w.recommendation.replace(/"/g,'""')}",${w.impact},${w.effort}
`});break;case"content-analysis":const P=d;r+=`Content Analysis Export
`,r+=`Analysis Name,${P.name}
`,r+=`URL,${P.url||"N/A"}
`,r+=`Timestamp,${new Date(P.timestamp).toISOString()}
`,r+=`SEO Score,${P.analysis.seoScore}
`,r+=`Readability Score,${P.analysis.readabilityScore}
`,r+=`Content Length,${P.analysis.contentLength} words
`,r+=`Keyword Density,${P.analysis.keywordDensity}%

`,r+=`Analyzed Content:
`,r+=`"${P.content.replace(/"/g,'""')}"

`,r+=`Suggestions:
`,r+=`Category,Suggestion,Priority
`,P.analysis.suggestions.forEach(w=>{r+=`${w.category},"${w.suggestion.replace(/"/g,'""')}",${w.priority}
`});break;case"structure-analysis":const S=d;r+=`Structure Analysis Export
`,r+=`Analysis Name,${S.name}
`,r+=`Timestamp,${new Date(S.timestamp).toISOString()}
`,r+=`Original Content Length,${S.originalContent.length} characters
`,r+=`Structured Content Length,${S.structuredContent.length} characters

`,r+=`Analysis Scores:
`,S.analysis.geoScoreTotal!==void 0&&(r+=`GEO Score,${S.analysis.geoScoreTotal}/100
`),S.analysis.contentQualityScoreTotal!==void 0&&(r+=`Content Quality Score,${S.analysis.contentQualityScoreTotal}/100
`),r+=`
`,r+=`Content Metadata:
`,r+=`Title,${S.analysis.metadata.title}
`,r+=`Description,${S.analysis.metadata.description}
`,r+=`Keywords,"${S.analysis.metadata.keywords.join(", ")}"
`,r+=`Author,${S.analysis.metadata.author}
`,r+=`Publish Date,${S.analysis.metadata.publishDate}
`,r+=`Last Modified,${S.analysis.metadata.lastModified}
`,r+=`Reading Time,${S.analysis.metadata.readingTime} minutes
`,r+=`Word Count,${S.analysis.metadata.wordCount}
`,r+=`Language,${S.analysis.metadata.language}

`,r+=`Original Content:
`,r+=`"${S.originalContent.replace(/"/g,'""')}"

`,r+=`Structured Content:
`,r+=`"${S.structuredContent.replace(/"/g,'""')}"

`,r+=`Structure Suggestions:
`,r+=`Type,Priority,Description,Implementation,Impact
`,S.analysis.suggestions.forEach(w=>{r+=`${w.type},${w.priority},"${w.description.replace(/"/g,'""')}","${w.implementation.replace(/"/g,'""')}","${w.impact.replace(/"/g,'""')}"
`});break;default:r+=`Unknown Type Export
`,r+=`Name,${d.name}
`,r+=`Type,${d.type}
`,r+=`Status,${d.status}
`,r+=`Timestamp,${new Date(d.timestamp).toISOString()}
`,r+=`Description,${d.description||"N/A"}
`}const R=`${d.type}-${d.name.replace(/[^a-zA-Z0-9]/g,"-")}-${new Date(d.timestamp).toISOString().split("T")[0]}.csv`;n(r,R,"text/csv")},T=t=>{confirm("Are you sure you want to delete this history item? This action cannot be undone.")&&(oe.deleteHistoryItem(t),N(s=>s+1))},K=()=>{const t=E.size>0?g.filter(d=>E.has(d.id)):g,s={exportedAt:new Date().toISOString(),total:t.length,filtersApplied:{...x},items:t};n(JSON.stringify(s,null,2),"history-export.json","application/json")},ee=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),ae=t=>{switch(t){case"date":return e.jsx(ut,{className:"h-4 w-4"});case"type":return e.jsx($e,{className:"h-4 w-4"});case"status":return e.jsx(dt,{className:"h-4 w-4"});default:return e.jsx($e,{className:"h-4 w-4"})}};return e.jsxs("div",{className:"max-w-7xl mx-auto py-6 px-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-gray-900 mb-3",children:"Comprehensive History"}),e.jsx("p",{className:"text-gray-600 text-base lg:text-lg",children:"View and manage all your analysis history including Q&A, AI visibility, content analysis, and structure analysis"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 text-center shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Total Items"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:g.length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 text-center shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Q&A Sessions"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:g.filter(t=>t.type==="qa").length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 text-center shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"AI Visibility"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:g.filter(t=>t.type==="ai-visibility").length})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-gray-200 text-center shadow-sm",children:[e.jsx("div",{className:"text-sm font-semibold text-gray-700 mb-1",children:"Selected Items"}),e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:E.size})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mb-6",children:[e.jsxs("button",{onClick:c,className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold shadow hover:bg-blue-700 transition flex items-center gap-2 justify-center",children:[e.jsx(J,{className:"h-4 w-4"}),"Export CSV"]}),e.jsxs("button",{onClick:K,className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold shadow hover:bg-blue-700 transition flex items-center gap-2 justify-center",children:[e.jsx(J,{className:"h-4 w-4"}),"Export JSON"]}),e.jsxs("button",{onClick:()=>{localStorage.removeItem("comprehensive_history"),l([]),f([]),h([]),alert("History cleared. Please refresh the page.")},className:"bg-blue-600 text-white px-4 py-2 rounded-lg font-semibold shadow hover:bg-blue-700 transition flex items-center gap-2 justify-center",children:[e.jsx(De,{className:"h-4 w-4"}),"Reset History"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 mb-6 overflow-visible relative",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(it,{className:"h-5 w-5"}),"Filters & Organization"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{onClick:()=>L(t=>({...t,showFilters:!t.showFilters})),className:"bg-gray-100 hover:bg-gray-200 text-gray-700 px-3 py-2 rounded-lg flex items-center gap-2 transition text-sm",children:[x.showFilters?e.jsx(Pe,{className:"h-4 w-4"}):e.jsx(Le,{className:"h-4 w-4"}),x.showFilters?"Hide":"Show"," Filters"]}),e.jsxs("button",{onClick:()=>{console.log("[History] Manual refresh triggered");const t=oe.getHistoryItems();l(t),N(s=>s+1)},className:"bg-green-100 hover:bg-green-200 text-green-700 px-3 py-2 rounded-lg flex items-center gap-2 transition text-sm",children:[e.jsx(De,{className:"h-4 w-4"}),"Refresh"]}),e.jsxs("div",{className:"flex items-center gap-1 bg-blue-50 px-3 py-2 rounded-lg",children:[e.jsx("span",{className:"text-sm font-medium text-black",children:"Group by:"}),e.jsxs("select",{value:x.groupBy,onChange:t=>L(s=>({...s,groupBy:t.target.value})),className:"text-sm border-0 bg-transparent text-blue-700 font-medium focus:ring-0 focus:outline-none",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"type",children:"Type"}),e.jsx("option",{value:"status",children:"Status"})]})]})]})]}),x.showFilters&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(ct,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search all analysis...",value:x.searchTerm,onChange:t=>We(t,s=>L(d=>({...d,searchTerm:s}))),onPaste:t=>_e(t,s=>L(d=>({...d,searchTerm:s}))),onKeyDown:t=>{Ze(t)||t.preventDefault()},className:"w-full pl-10 pr-4 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 placeholder-grey-400 relative z-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date Range"}),e.jsxs("select",{value:x.dateFilter,onChange:t=>L(s=>({...s,dateFilter:t.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"all",children:"All Time"}),e.jsx("option",{value:"today",children:"Today"}),e.jsx("option",{value:"week",children:"Last 7 Days"}),e.jsx("option",{value:"month",children:"Last 30 Days"}),e.jsx("option",{value:"year",children:"Last Year"}),e.jsx("option",{value:"specific",children:"Specific date…"})]}),x.dateFilter==="specific"&&e.jsx("div",{className:"mt-2",children:e.jsx("input",{type:"date",value:x.specificDate,onChange:t=>L(s=>({...s,specificDate:t.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Analysis Type"}),e.jsxs("select",{value:x.typeFilter,onChange:t=>L(s=>({...s,typeFilter:t.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"all",children:"All Types"}),H.types.map(t=>e.jsx("option",{value:t,children:t?_(t):"Unknown"},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:x.statusFilter,onChange:t=>L(s=>({...s,statusFilter:t.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"all",children:"All Status"}),H.statuses.map(t=>e.jsx("option",{value:t,children:t?t.charAt(0).toUpperCase()+t.slice(1):"Unknown"},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort By"}),e.jsxs("select",{value:x.sortBy,onChange:t=>L(s=>({...s,sortBy:t.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"date",children:"Date"}),e.jsx("option",{value:"name",children:"Name"}),e.jsx("option",{value:"type",children:"Type"}),e.jsx("option",{value:"status",children:"Status"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Sort Order"}),e.jsxs("select",{value:x.sortOrder,onChange:t=>L(s=>({...s,sortOrder:t.target.value})),className:"w-full px-3 py-2 border border-grey-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent bg-white text-blue-600 relative z-10",children:[e.jsx("option",{value:"desc",children:"Newest First"}),e.jsx("option",{value:"asc",children:"Oldest First"})]})]})]})]}),e.jsx("div",{className:"space-y-4",children:k.length===0?e.jsxs("div",{className:"py-12 bg-white rounded-lg border border-gray-200 shadow-sm",children:[e.jsx(Oe,{className:"h-12 w-12 text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No history found"}),e.jsx("p",{className:"text-gray-500",children:"Try adjusting your filters or create some analysis first."})]}):k.map(t=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden shadow-sm",children:[e.jsx("div",{className:"p-4 cursor-pointer hover:bg-gray-50 transition-colors border-b border-gray-200",onClick:()=>X(t.groupKey),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[ae(t.groupType),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.groupTitle}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{children:[t.items.length," items"]}),e.jsxs("span",{children:[t.totalItems," total"]})]})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:A.has(t.groupKey)?e.jsx(Pe,{className:"h-5 w-5 text-gray-500"}):e.jsx(Le,{className:"h-5 w-5 text-gray-500"})})]})}),A.has(t.groupKey)&&e.jsx("div",{className:"p-4 space-y-3",children:t.items.map(s=>{try{return e.jsx("div",{className:"border border-gray-200 rounded-lg p-3",children:Z(s)},s.id)}catch(d){return console.error("[History] Error rendering item in group:",d,s),e.jsxs("div",{className:"border border-red-200 rounded-lg p-3 bg-red-50",children:[e.jsxs("div",{className:"text-red-600",children:["Error rendering item: ",d.message]}),e.jsxs("div",{className:"text-xs text-red-500 mt-2",children:["Item ID: ",s.id]})]},s.id)}})})]},t.groupKey))})]})}class St extends st.Component{constructor(n){super(n),this.state={hasError:!1}}static getDerivedStateFromError(n){return{hasError:!0,message:String(n?.message||"Unexpected error")}}componentDidCatch(n,m){console.error("[ErrorBoundary]",n,m)}handleReset=()=>{try{Object.keys(localStorage).forEach(n=>{n.startsWith("structure_analysis_state")&&localStorage.removeItem(n)})}catch{}this.setState({hasError:!1,message:void 0});try{window.location.reload()}catch{}};render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs("div",{className:"max-w-lg w-full bg-white border border-gray-200 rounded-xl p-6 text-center",children:[e.jsx("h2",{className:"text-xl font-bold text-black mb-2",children:"Something went wrong"}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:this.state.message||"The page failed to render."}),e.jsx("button",{className:"bg-black text-white px-4 py-2 rounded-lg hover:bg-gray-800",onClick:this.handleReset,children:"Reset Structure Analysis"})]})}):this.props.children}}function kt(){const a=Re(),n=ie(),{content:m="",url:l=""}=a.state||{},g=()=>{n(-1)};return e.jsx(St,{fallbackMessage:"Structure analysis failed. Click reset and then Restore Last Analysis to reload your previous results.",children:e.jsx(Je,{content:m,url:l,onBack:g})})}const Ct=({password:a,className:n=""})=>{const m=/[A-Z]/.test(a),l=/[a-z]/.test(a),g=/\d/.test(a),f=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(a),k=a.length>=8,h=m&&l&&g&&f&&k;return a.length===0?null:e.jsx("div",{className:`text-sm ${h?"text-green-600":"text-red-600"} ${n}`,children:h?"✅ Password meets all requirements":"❌ Password must contain: at least 8 characters, one uppercase letter, one lowercase letter, one number, and one special character"})},At=()=>{const[a,n]=u.useState({firstName:"",lastName:"",email:"",password:"",confirmPassword:""}),[m,l]=u.useState(""),[g,f]=u.useState(!1),[k,h]=u.useState(!1),[A,$]=u.useState(!1),[E,D]=u.useState(!1),[F,N]=u.useState(null),[x,L]=u.useState(!0),H=ie(),{login:X,error:B,clearError:_,isAuthenticated:V}=be(),{handleInputChangeAggressive:Z,handlePaste:G,handleKeyDown:U}=Se();u.useEffect(()=>{const i=setTimeout(()=>{L(!1)},100);return()=>clearTimeout(i)},[]),u.useEffect(()=>{const i=async()=>{if(V){console.log("[SignUp] User is authenticated via AuthContext, redirecting to overview..."),H("/overview",{replace:!0});return}if(te.isAuthenticated()){console.log("[SignUp] User is authenticated via authService, redirecting to overview..."),H("/overview",{replace:!0});return}};i();const c=setInterval(i,100);return()=>clearInterval(c)},[H,V]);const b=async i=>{if(i.preventDefault(),l(""),N(null),!a.firstName.trim()){l("First name is required");return}if(!a.lastName.trim()){l("Last name is required");return}if(!a.email.trim()){l("Email is required");return}if(!a.password.trim()){l("Password is required");return}if(!a.confirmPassword.trim()){l("Please confirm your password");return}const c=/^[A-Za-z]+$/;if(!c.test(a.firstName)){if(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(a.firstName)){l("First name cannot contain emojis");return}if(/[^A-Za-z]/.test(a.firstName)){l("First name can only contain letters (A-Z, a-z). No numbers, spaces, or special characters allowed.");return}l("First name can contain only letters (A-Z, a-z)");return}if(!c.test(a.lastName)){if(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(a.lastName)){l("Last name cannot contain emojis");return}if(/[^A-Za-z]/.test(a.lastName)){l("Last name can only contain letters (A-Z, a-z). No numbers, spaces, or special characters allowed.");return}l("Last name can contain only letters (A-Z, a-z)");return}if(a.firstName.trim().length<2){l("First name must be at least 2 characters long");return}if(a.firstName.trim().length>30){l("First name cannot exceed 30 characters");return}if(a.lastName.trim().length<2){l("Last name must be at least 2 characters long");return}if(a.lastName.trim().length>30){l("Last name cannot exceed 30 characters");return}const v=Y(a.email);if(!v.isValid){l(se(a.email,v));return}l("");const j=a.password;if(j.length<4){l("Password must be at least 4 characters long");return}if(j.length>128){l("Password cannot exceed 128 characters");return}if(!/[A-Z]/.test(j)){l("Password must contain at least one uppercase letter (A-Z)");return}if(!/[a-z]/.test(j)){l("Password must contain at least one lowercase letter (a-z)");return}if(!/\d/.test(j)){l("Password must contain at least one number (0-9)");return}if(!/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(j)){l("Password must contain at least one special character (!@#$%^&*()_+-=[]{};':\"\\|,.<>/?`)");return}if(/(.)\1{2,}/.test(j)){l("Password cannot contain 3 or more repeated characters");return}if(/abc|bcd|cde|def|efg|fgh|ghi|hij|ijk|jkl|klm|lmn|mno|nop|opq|pqr|qrs|rst|stu|tuv|uvw|vwx|wxy|xyz/i.test(j)){l("Password cannot contain sequential characters (abc, 123, etc.)");return}if(/qwerty|asdfgh|zxcvbn|123456|654321/i.test(j)){l("Password cannot contain common keyboard patterns");return}if(a.password!==a.confirmPassword){l("Passwords do not match");return}f(!0),_();try{const T=await te.register({email:a.email,password:a.password,name:`${a.firstName} ${a.lastName}`,displayName:`${a.firstName} ${a.lastName}`});T.success?(console.log("[SignUp] Sign up successful, user is now logged in"),N(""),l(""),console.log("[SignUp] Forcing immediate navigation to overview..."),H("/overview",{replace:!0})):l(T.error||"Sign up failed. Please try again.")}catch(T){console.error("[SignUp] Sign up error:",T);let K="Sign up failed. Please try again.";T&&typeof T=="object"&&(T.message&&typeof T.message=="string"?T.message.includes("already exists")||T.message.includes("duplicate")?K="Account already exists on this email":T.message.includes("Network")||T.message.includes("fetch")?K="Network error. Please check your connection and try again.":K=T.message:T.error&&typeof T.error=="string"&&(T.error.includes("already exists")||T.error.includes("duplicate")?K="Account already exists on this email":T.error.includes("Network")||T.error.includes("connection")?K="Network error. Please check your connection and try again.":K=T.error)),console.log("[SignUp] Setting authentication error message:",K),N(K),l("")}finally{f(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-blue-100 via-indigo-100 to-purple-100 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-blue-300/30 via-indigo-300/30 to-purple-300/30"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-tr from-cyan-200/20 via-blue-200/20 to-indigo-200/20"}),e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-gradient-to-br from-blue-400/40 to-cyan-400/40 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-[500px] h-[500px] bg-gradient-to-tl from-purple-400/40 to-pink-400/40 rounded-full blur-3xl translate-x-1/2 translate-y-1/2 animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-80 h-80 bg-gradient-to-r from-indigo-400/35 to-blue-400/35 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute top-1/4 right-1/4 w-32 h-32 bg-gradient-to-br from-cyan-300/30 to-blue-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute bottom-1/4 left-1/4 w-24 h-24 bg-gradient-to-br from-purple-300/30 to-pink-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"1.5s"}}),e.jsxs("div",{className:"w-full max-w-md mx-auto p-8 bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 relative z-10 bg-gradient-to-br from-white/95 via-white/90 to-white/95",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"w-24 h-24 bg-black rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(ce,{className:"w-12 h-12 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-black mb-3",children:"Create your account"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Sign up to get started with kabini.ai"})]}),e.jsxs("form",{onSubmit:b,className:"space-y-8",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["First Name ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"firstName",value:a.firstName,onChange:i=>Z(i,c=>{const v=c.replace(/[^A-Za-z]/g,"");if(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(c)){l("First name cannot contain emojis");return}n(j=>({...j,firstName:v})),m&&l("")}),onPaste:i=>G(i,c=>{const v=c.replace(/[^A-Za-z]/g,"");n(j=>({...j,firstName:v}))}),onKeyDown:U,onCompositionStart:i=>i.preventDefault(),onCompositionUpdate:i=>i.preventDefault(),onCompositionEnd:i=>i.preventDefault(),required:!0,placeholder:"Enter your first name *",pattern:"[A-Za-z]+",autoComplete:"off","data-form-type":"other",readOnly:x,className:"w-full px-4 py-4 border-2 border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Last Name ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"text",name:"lastName",value:a.lastName,onChange:i=>Z(i,c=>{const v=c.replace(/[^A-Za-z]/g,"");if(/[\u{1F600}-\u{1F64F}]|[\u{1F300}-\u{1F5FF}]|[\u{1F680}-\u{1F6FF}]|[\u{1F1E0}-\u{1F1FF}]|[\u{2600}-\u{26FF}]|[\u{2700}-\u{27BF}]/u.test(c)){l("Last name cannot contain emojis");return}n(j=>({...j,lastName:v})),m&&l("")}),onPaste:i=>G(i,c=>{const v=c.replace(/[^A-Za-z]/g,"");n(j=>({...j,lastName:v}))}),onKeyDown:U,onCompositionStart:i=>i.preventDefault(),onCompositionUpdate:i=>i.preventDefault(),onCompositionEnd:i=>i.preventDefault(),required:!0,placeholder:"Enter your last name *",pattern:"[A-Za-z]+",autoComplete:"off","data-form-type":"other",readOnly:x,className:"w-full px-4 py-4 border-2 border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Email ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"email",name:"email",value:a.email,onChange:i=>Z(i,c=>{const v=de(c);if(n(j=>({...j,email:v})),m&&l(""),!v.trim())l("");else{const j=Y(v);j.isValid?l(""):l(se(v,j))}}),onPaste:i=>G(i,c=>{const v=de(c);n(T=>({...T,email:v}));const j=Y(v);j.isValid?l(""):l(se(v,j))}),onKeyDown:U,onCompositionStart:i=>i.preventDefault(),onCompositionUpdate:i=>i.preventDefault(),onCompositionEnd:i=>i.preventDefault(),required:!0,autoComplete:"off","data-form-type":"other",readOnly:x,placeholder:"Enter your email address *",className:`w-full px-4 py-4 border-2 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all ${m?"border-red-500 focus:ring-red-500 focus:border-red-500":"border-gray-300"}`}),m&&e.jsxs("p",{className:"mt-2 text-sm text-red-600 flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4 flex-shrink-0",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})}),m]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:k?"text":"password",name:"password",value:a.password,onChange:i=>Z(i,c=>{n(t=>({...t,password:c})),m&&l("");const v=/[A-Z]/.test(c),j=/[a-z]/.test(c),T=/\d/.test(c),K=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(c),ee=c.length>=8,ae=v&&j&&T&&K&&ee;D(ae),ae&&l("")}),onPaste:i=>G(i,c=>{n(t=>({...t,password:c}));const v=/[A-Z]/.test(c),j=/[a-z]/.test(c),T=/\d/.test(c),K=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(c),ee=c.length>=8,ae=v&&j&&T&&K&&ee;D(ae),ae&&l("")}),onKeyDown:U,onCompositionStart:i=>i.preventDefault(),onCompositionUpdate:i=>i.preventDefault(),onCompositionEnd:i=>i.preventDefault(),required:!0,autoComplete:"new-password","data-form-type":"other",readOnly:x,placeholder:"Create a password *",className:"w-full px-4 pr-12 py-4 border-2 border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all"}),e.jsx("button",{type:"button",onClick:()=>h(!k),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors focus:outline-none",tabIndex:-1,"aria-label":k?"Hide password":"Show password",children:k?e.jsx(me,{className:"w-5 h-5"}):e.jsx(le,{className:"w-5 h-5"})})]}),e.jsx(Ct,{password:a.password,className:"mt-3"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Confirm Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:A?"text":"password",name:"confirmPassword",value:a.confirmPassword,onChange:i=>Z(i,c=>{n(v=>({...v,confirmPassword:c})),m&&l("")}),onPaste:i=>G(i,c=>{n(v=>({...v,confirmPassword:c}))}),onKeyDown:U,onCompositionStart:i=>i.preventDefault(),onCompositionUpdate:i=>i.preventDefault(),onCompositionEnd:i=>i.preventDefault(),required:!0,autoComplete:"new-password","data-form-type":"other",readOnly:x,placeholder:"Re-enter your password *",className:"w-full px-4 pr-12 py-4 border-2 border-gray-300 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all"}),e.jsx("button",{type:"button",onClick:()=>$(!A),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors focus:outline-none",tabIndex:-1,"aria-label":A?"Hide confirm password":"Show confirm password",children:A?e.jsx(me,{className:"w-5 h-5"}):e.jsx(le,{className:"w-5 h-5"})})]})]}),e.jsx("button",{type:"submit",disabled:g,className:"w-full bg-black text-white font-bold py-4 px-6 rounded-xl hover:bg-gray-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",children:g?e.jsx(re,{className:"w-5 h-5 animate-spin"}):"Create Account"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsx("span",{onClick:()=>H("/login"),className:"text-sm text-black hover:text-gray-700 underline hover:no-underline transition-colors cursor-pointer",children:"Already have an account? Sign in"})})]}),e.jsx(ge,{error:F||B,onClose:()=>{N(null),_()},autoClose:!0,autoCloseDelay:5e3})]})},Et=()=>{const[a,n]=u.useState(""),[m,l]=u.useState(!1),[g,f]=u.useState(null),[k,h]=u.useState(!1),A=ie(),{handleInputChangeAggressive:$,handlePaste:E,handleKeyDown:D}=Se(),F=async N=>{if(N.preventDefault(),console.log("[ForgotPassword] Form submitted, clearing previous errors"),f(""),!a||!a.trim()){console.log("[ForgotPassword] Email is empty, setting validation error"),f("Please enter your email address");return}try{const x=Y(a);if(!x||!x.isValid){console.log("[ForgotPassword] Email validation failed, setting validation error"),f("Please enter a valid email address");return}}catch(x){console.log("[ForgotPassword] Email validation error:",x),f("Please enter a valid email address");return}console.log("[ForgotPassword] Starting API call to forgot-password endpoint"),h(!0);try{const x=await fetch("/api/auth/forgot-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a.trim()})}),L=await x.json();console.log("[ForgotPassword] Response:",x.status,L),x.ok?(console.log("[ForgotPassword] Password reset email sent successfully"),l(!0)):(console.error("[ForgotPassword] Failed to send reset email:",L.error),f(L.error||"Failed to send reset email. Please try again."))}catch(x){console.error("[ForgotPassword] Error during forgot password request:",x),f("Network error. Please check your connection and try again.")}finally{h(!1)}};return e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 px-4 relative overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-gray-200/30"}),e.jsx("div",{className:"absolute inset-0 bg-gray-300/20"}),e.jsx("div",{className:"absolute top-0 left-0 w-96 h-96 bg-gradient-to-br from-blue-400/40 to-cyan-400/40 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-[500px] h-[500px] bg-gradient-to-tl from-purple-400/40 to-pink-400/40 rounded-full blur-3xl translate-x-1/2 translate-y-1/2 animate-pulse",style:{animationDelay:"1s"}}),e.jsx("div",{className:"absolute top-1/2 left-1/2 w-80 h-80 bg-gradient-to-r from-indigo-400/35 to-blue-400/35 rounded-full blur-3xl -translate-x-1/2 -translate-y-1/2 animate-pulse",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute top-1/4 right-1/4 w-32 h-32 bg-gradient-to-br from-cyan-300/30 to-blue-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"0.5s"}}),e.jsx("div",{className:"absolute bottom-1/4 left-1/4 w-24 h-24 bg-gradient-to-br from-purple-300/30 to-pink-300/30 rounded-full blur-2xl animate-bounce",style:{animationDelay:"1.5s"}}),e.jsxs("div",{className:"w-full max-w-md mx-auto p-8 bg-white/90 backdrop-blur-md rounded-2xl shadow-2xl border border-white/30 relative z-10 bg-gradient-to-br from-white/95 via-white/90 to-white/95",children:[e.jsxs("div",{className:"text-center mb-10",children:[e.jsx("div",{className:"w-24 h-24 bg-black rounded-2xl flex items-center justify-center mx-auto mb-6 shadow-lg",children:e.jsx(ce,{className:"w-12 h-12 text-white"})}),e.jsx("h1",{className:"text-4xl font-bold text-black mb-3",children:"Forgot your password?"}),e.jsx("p",{className:"text-gray-600 text-lg",children:"Enter your email address and we'll send you a link to reset your password."})]}),m?e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 mb-6",children:[e.jsx("div",{className:"text-green-600 font-semibold mb-2",children:"Check your email"}),e.jsxs("div",{className:"text-gray-600 text-sm",children:["If an account with that email exists, a reset link has been sent to ",e.jsx("strong",{children:a}),"."]})]}),e.jsxs("button",{onClick:()=>A("/login"),className:"w-full bg-black text-white font-bold py-4 px-6 rounded-xl hover:bg-gray-800 transition-all duration-200 flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",children:[e.jsx(ye,{className:"w-5 h-5"}),"Back to Login"]})]}):e.jsxs("form",{onSubmit:F,className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-3",children:["Email ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsx("input",{type:"email",value:a,onChange:N=>$(N,x=>{const L=de(x);n(L);const H=Y(L);H.isValid?f(null):f(se(L,H))}),onPaste:N=>E(N,x=>{const L=de(x);n(L);const H=Y(L);H.isValid?f(null):f(se(L,H))}),onKeyDown:D,onCompositionStart:N=>N.preventDefault(),onCompositionUpdate:N=>N.preventDefault(),onCompositionEnd:N=>N.preventDefault(),required:!0,placeholder:"Enter your email address *",className:"w-full px-4 py-4 border-2 rounded-xl text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-black focus:border-black transition-all border-gray-300"})]}),e.jsx("button",{type:"submit",disabled:k,className:"w-full bg-black text-white font-bold py-4 px-6 rounded-xl hover:bg-gray-800 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",children:k?e.jsx(re,{className:"w-5 h-5 animate-spin"}):"Send Reset Link"}),e.jsxs("button",{type:"button",onClick:()=>A("/login"),className:"w-full bg-black text-white font-bold py-4 px-6 rounded-xl hover:bg-gray-800 transition-all duration-200 flex items-center justify-center gap-2 shadow-lg transform hover:scale-[1.02]",children:[e.jsx(ye,{className:"w-5 h-5"}),"Back to Login"]})]})]}),e.jsx(ge,{error:g,onClose:()=>f(null),autoClose:!0,autoCloseDelay:5e3,type:"error"})]})},Dt=()=>{const[a]=at(),[n,m]=u.useState({password:"",confirmPassword:""}),[l,g]=u.useState(""),[f,k]=u.useState(!1),[h,A]=u.useState(!1),[$,E]=u.useState(!1),[D,F]=u.useState(!0),[N,x]=u.useState(!1),[L,H]=u.useState(!1),[X,B]=u.useState(!1),_=ie(),V=a.get("token");u.useEffect(()=>{if(!V){g("Invalid reset link. Please request a new password reset."),F(!1);return}console.log("[ResetPassword] Token found in URL, showing reset form"),E(!0),F(!1)},[V]);const Z=b=>{const{name:i,value:c}=b.target;if(m({...n,[i]:c}),i==="password"){const v=c.length>=8&&/[a-z]/.test(c)&&/[A-Z]/.test(c)&&/\d/.test(c);B(v)}},G=()=>n.password?n.confirmPassword?n.password.length<8?(g("Password must be at least 8 characters long"),!1):/(?=.*[a-z])/.test(n.password)?/(?=.*[A-Z])/.test(n.password)?/(?=.*\d)/.test(n.password)?n.password!==n.confirmPassword?(g("Passwords do not match"),!1):!0:(g("Password must contain at least one number"),!1):(g("Password must contain at least one uppercase letter"),!1):(g("Password must contain at least one lowercase letter"),!1):(g("Please confirm your password"),!1):(g("Password is required"),!1),U=async b=>{if(b.preventDefault(),g(""),!!G()){if(!V){g("Invalid reset token. Please request a new password reset.");return}k(!0);try{console.log("[ResetPassword] Attempting to reset password with token:",V);const i=await fetch("/api/auth/reset-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:V,newPassword:n.password})}),c=await i.json();console.log("[ResetPassword] Response:",i.status,c),i.ok?(console.log("[ResetPassword] Password reset successful"),A(!0)):(console.error("[ResetPassword] Password reset failed:",c.error),g(c.error||"Failed to reset password. Please try again."))}catch(i){console.error("[ResetPassword] Error during password reset:",i),g("Network error. Please check your connection and try again.")}finally{k(!1)}}};return D?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-lg shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx(re,{className:"w-8 h-8 animate-spin mx-auto mb-4 text-blue-600"}),e.jsx("div",{className:"text-gray-600",children:"Verifying reset link..."})]})})}):$?h?e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-lg shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx(gt,{className:"w-8 h-8 text-green-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Password Reset Successfully"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Your password has been updated. You can now log in with your new password."}),e.jsxs("button",{onClick:()=>_("/login"),className:"w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all flex items-center justify-center gap-2",children:[e.jsx(ye,{className:"w-5 h-5"}),"Back to Login"]})]})})}):e.jsxs("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:[e.jsxs("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx(ce,{className:"w-8 h-8 text-blue-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Reset Your Password"}),e.jsx("p",{className:"text-gray-600",children:"Enter your new password below"})]}),e.jsxs("form",{onSubmit:U,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["New Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:N?"text":"password",name:"password",value:n.password,onChange:Z,required:!0,placeholder:"Enter your new password",className:"w-full px-4 pr-12 py-3 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("button",{type:"button",onClick:()=>x(!N),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",tabIndex:-1,"aria-label":N?"Hide password":"Show password",children:N?e.jsx(me,{className:"w-5 h-5"}):e.jsx(le,{className:"w-5 h-5"})})]}),e.jsx("div",{className:`mt-2 text-xs ${X?"text-green-600":"text-gray-500"}`,children:X?"Password meets requirements":"Must be at least 8 characters with uppercase, lowercase, and number"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-900 mb-2",children:["Confirm New Password ",e.jsx("span",{className:"text-red-600",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:L?"text":"password",name:"confirmPassword",value:n.confirmPassword,onChange:Z,required:!0,placeholder:"Re-enter your new password",className:"w-full px-4 pr-12 py-3 border border-gray-300 rounded-lg text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),e.jsx("button",{type:"button",onClick:()=>H(!L),className:"absolute right-3 top-1/2 -translate-y-1/2 text-gray-400 hover:text-gray-600",tabIndex:-1,"aria-label":L?"Hide confirm password":"Show confirm password",children:L?e.jsx(me,{className:"w-5 h-5"}):e.jsx(le,{className:"w-5 h-5"})})]})]}),e.jsx("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:f?e.jsx(re,{className:"w-5 h-5 animate-spin"}):"Reset Password"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("button",{type:"button",onClick:()=>_("/login"),className:"w-full bg-blue-500 border-2 border-blue-600 text-white hover:bg-blue-600 hover:text-white font-bold py-3 px-6 rounded-lg transition-all duration-200 flex items-center justify-center gap-2 shadow-lg",children:[e.jsx(ye,{className:"w-5 h-5"}),"Back to Login"]})})]}),e.jsx(ge,{error:l,onClose:()=>g(""),autoClose:!0,autoCloseDelay:5e3})]}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-100",children:e.jsx("div",{className:"w-full max-w-md mx-auto p-8 bg-white rounded-lg shadow-sm",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-lg flex items-center justify-center mx-auto mb-4",children:e.jsx(ce,{className:"w-8 h-8 text-red-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"Invalid Reset Link"}),e.jsx("p",{className:"text-gray-600 mb-6",children:l}),e.jsx("button",{onClick:()=>_("/forgot-password"),className:"w-full bg-blue-600 text-white font-bold py-3 px-6 rounded-lg hover:bg-blue-700 transition-all",children:"Request New Reset Link"})]})})})},Pt=()=>{const[a,n]=u.useState(null),[m,l]=u.useState(null),g=()=>{n("Invalid email or password. Please check your credentials and try again.")},f=()=>{l("Login successful! Welcome back.")},k=()=>{n("Your session will expire soon. Please save your work.")};return e.jsxs("div",{className:"p-8 space-y-4",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"Notification Test"}),e.jsxs("div",{className:"space-x-4",children:[e.jsx("button",{onClick:g,className:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600",children:"Show Error"}),e.jsx("button",{onClick:f,className:"px-4 py-2 bg-green-500 text-white rounded hover:bg-green-600",children:"Show Success"}),e.jsx("button",{onClick:k,className:"px-4 py-2 bg-yellow-500 text-white rounded hover:bg-yellow-600",children:"Show Warning"})]}),e.jsx(ge,{error:a,onClose:()=>n(null),autoClose:!0,autoCloseDelay:5e3,type:"error"}),e.jsx(qe,{message:m,onClose:()=>l(null),autoClose:!0,autoCloseDelay:3e3})]})},Ie="llm_qa_sessions",je="llm_qa_current_session";function Lt(){const{user:a}=be();ie();const[n,m]=u.useState([]),[l,g]=u.useState([]),[f,k]=u.useState(new Set),[h,A]=u.useState(!1),[$,E]=u.useState(!1),[D,F]=u.useState("gemini"),[N,x]=u.useState("gemini-1.5-flash"),[L,H]=u.useState([]),[X,B]=u.useState(!1),[_,V]=u.useState(!1),[Z,G]=u.useState(null),[U,b]=u.useState(""),[i,c]=u.useState([]),[v,j]=u.useState(""),[T,K]=u.useState(!1),[ee,ae]=u.useState(!1),[t,s]=u.useState([]),[d,r]=u.useState(null),[R,q]=u.useState(new Set),[M,P]=u.useState(null),S=u.useRef(null),w=(o,y)=>`${o}_${y}`,I=o=>{try{return new URL(o.trim()),!0}catch{return!1}},ue=o=>{const y=o.trim();if(I(y))return y;const p=/https?:\/\/[^\s]+/g,O=y.match(p);return O?O[0]:null};u.useEffect(()=>{if(S.current&&U){S.current.style.height="auto";const o=Math.max(36,Math.min(S.current.scrollHeight,150));S.current.style.height=o+"px"}},[U]),u.useEffect(()=>{switch(D){case"gemini":x("gemini-1.5-flash");break;case"openai":x("gpt-3.5-turbo");break;case"perplexity":x("sonar");break;default:x("gemini-1.5-flash")}},[D]),u.useEffect(()=>{if(a?.id){const o=w(Ie,a.id),y=w(je,a.id);try{const p=localStorage.getItem(o);if(p){const C=JSON.parse(p);s(C)}const O=localStorage.getItem(y);if(O){const C=JSON.parse(O);r(C),C&&C.type==="faq"&&(m(C.qaData||[]),B(!0),b(C.blogContent||""),F(C.questionProvider||"gemini"),x(C.questionModel||(C.questionProvider==="perplexity"?"sonar":"gemini-1.5-flash")))}}catch(p){console.error("[Session Loading] Error loading sessions:",p)}}},[a?.id]),u.useEffect(()=>{if(a?.id&&t.length>0){const o=w(Ie,a.id);try{localStorage.setItem(o,JSON.stringify(t))}catch(y){console.error("[Session Saving] Error saving sessions:",y)}}},[t,a?.id]),u.useEffect(()=>{if(a?.id&&d){const o=w(je,a.id);try{localStorage.setItem(o,JSON.stringify(d))}catch(y){console.error("[Session Saving] Error saving current session:",y)}}},[d,a?.id]),u.useEffect(()=>{a||(s([]),r(null),q(new Set),m([]),B(!1),b(""),A(!1),E(!1),G(null))},[a]),u.useEffect(()=>{d&&d.type==="faq"?(m(d.qaData||[]),B(!0),b(d.blogContent||""),F(d.questionProvider||"gemini"),x(d.questionModel||(d.questionProvider==="perplexity"?"sonar":"gemini-1.5-flash")),S.current&&d.blogContent&&setTimeout(()=>{if(S.current){S.current.style.height="auto";const o=Math.max(36,Math.min(S.current.scrollHeight,150));S.current.style.height=o+"px"}},100)):(m([]),B(!1))},[d]),u.useEffect(()=>{if(a?.id){const o=w("pending_faq_generation",a.id),y=w("generated_faqs",a.id);try{const p=localStorage.getItem(o);if(p){const C=JSON.parse(p);Date.now()-C.timestamp<5*60*1e3?(G(C),A(!0),b(C.content),F(C.provider),x(C.model),H(C.targetKeywords),He(C)):localStorage.removeItem(o)}const O=localStorage.getItem(y);if(O){const C=JSON.parse(O);Date.now()-C.timestamp<10*60*1e3&&(console.log("[Background FAQ] Restoring generated FAQs:",C.faqs.length),setTimeout(()=>{m(C.faqs),B(!0),b(C.content),F(C.provider),x(C.model),setIsGeneratingFAQs(!1),P(`Restored ${C.faqs.length} previously generated FAQs!`)},100)),localStorage.removeItem(y)}}catch(p){console.error("[Background FAQ] Error loading background data:",p),localStorage.removeItem(o),localStorage.removeItem(y)}}},[a?.id]);const He=async o=>{try{console.log("[Pending FAQ] Continuing FAQ generation for content length:",o.content.length);const y=await he.generateAIFAQs({content:o.content.trim(),provider:o.provider,model:o.model,targetKeywords:o.targetKeywords});if(y.faqs&&Array.isArray(y.faqs)&&y.faqs.length>0){if(console.log("[Pending FAQ] Successfully generated FAQs:",y.faqs.length),a?.id){const p=w("generated_faqs",a.id),O={faqs:y.faqs,content:o.content,provider:o.provider,model:o.model,timestamp:Date.now()};localStorage.setItem(p,JSON.stringify(O))}if(m(y.faqs),B(!0),setIsGeneratingFAQs(!1),G(null),a?.id){const p=w("pending_faq_generation",a.id);localStorage.removeItem(p)}if(a?.id){const p=ue(o.content),O={id:`faq-session-${Date.now()}`,name:`FAQ Session - ${new Date().toLocaleDateString()}`,type:"faq",timestamp:new Date().toISOString(),model:o.model,questionProvider:o.provider,answerProvider:o.provider,questionModel:o.model,answerModel:o.model,blogContent:o.content,blogUrl:p||void 0,sourceUrls:p?[p]:void 0,qaData:y.faqs.map(C=>({question:C.question,answer:C.answer})),totalInputTokens:o.content.length/4,totalOutputTokens:y.faqs.reduce((C,z)=>C+z.question.length+z.answer.length,0)/4,statistics:{totalQuestions:y.faqs.length,avgAccuracy:"85",avgCitationLikelihood:"75",totalCost:"0.01"},userId:a.id};s(C=>[O,...C]),r(O)}P(`Successfully generated ${y.faqs.length} FAQs!`)}else if(console.error("[Pending FAQ] Invalid response format:",y),P("Failed to generate FAQs. Please try again."),setIsGeneratingFAQs(!1),G(null),a?.id){const p=w("pending_faq_generation",a.id);localStorage.removeItem(p)}}catch(y){if(console.error("[Pending FAQ] Error generating FAQs:",y),P("Error generating FAQs. Please try again."),setIsGeneratingFAQs(!1),G(null),a?.id){const p=w("pending_faq_generation",a.id);localStorage.removeItem(p)}}},we=async()=>{if(!U.trim()){P("Please enter some content first");return}A(!0),V(!1),g([]),k(new Set);try{const o=await he.generateAIFAQs({content:U.trim(),provider:D,model:N,targetKeywords:L,generateQuestionsOnly:!0});if(o.success&&o.questions){const y=o.questions||[];g(y),V(!0),P(`Generated ${y.length} questions successfully!`)}else P("Failed to generate questions. Please try again.")}catch(o){console.error("[Questions Generation] Error:",o),P("Error generating questions. Please try again.")}finally{A(!1)}},Be=async()=>{if(f.size===0){P("Please select at least one question");return}E(!0),B(!1);try{const o=Array.from(f).map(p=>l[p]),y=await he.generateAIFAQs({content:U.trim(),provider:D,model:N,targetKeywords:L,selectedQuestions:o,generateAnswersOnly:!0});if(y.success&&y.faqs){const p=y.faqs||[];m(p),B(!0),P(`Generated answers for ${p.length} questions successfully!`),ze(p)}else P("Failed to generate answers. Please try again.")}catch(o){console.error("[Answers Generation] Error:",o),P("Error generating answers. Please try again.")}finally{E(!1)}},Ve=o=>{k(y=>{const p=new Set(y);return p.has(o)?p.delete(o):p.add(o),p})},ze=o=>{if(!a?.id)return;const y={id:`faq-${Date.now()}`,name:`FAQ Session - ${new Date().toLocaleDateString()}`,type:"faq",timestamp:new Date().toISOString(),model:N,questionProvider:D,answerProvider:D,questionModel:N,answerModel:N,blogContent:U,blogUrl:ue(U),sourceUrls:ue(U)?[ue(U)]:[],qaData:o,totalInputTokens:0,totalOutputTokens:0,statistics:{totalQuestions:o.length,avgAccuracy:"N/A",avgCitationLikelihood:"N/A",totalCost:"N/A"},userId:a.id};s(p=>[y,...p]),r(y)},Ge=async(o,y)=>{const p=`Q: ${o}
A: ${y}`;try{await navigator.clipboard.writeText(p),console.log("Q&A pair copied to clipboard")}catch(O){console.error("Failed to copy Q&A pair:",O)}},Ke=async o=>{if(!U.trim()){console.error("No content available for reanalysis");return}try{E(!0);const y=await he.generateAIFAQs({content:U,provider:D,model:N,targetKeywords:[],generateAnswersOnly:!0,selectedQuestions:[o]});if(y.success&&y.faqs&&y.faqs.length>0){const p=y.faqs[0].answer;m(O=>O.map(C=>C.question===o?{...C,answer:p}:C)),console.log("Answer reanalyzed successfully")}}catch(y){console.error("Error reanalyzing answer:",y)}finally{E(!1)}},ke=o=>{a?.id&&(s(y=>y.filter(O=>O.id!==o)),d?.id===o&&r(null),q(y=>{const p=new Set(y);return p.delete(o),p}))};return e.jsxs("div",{className:"flex gap-8 w-full",children:[e.jsx("div",{className:"flex-1 space-y-8",children:e.jsxs("div",{className:"card bg-white border border-primary/10 shadow-xl",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-6",children:[e.jsx(fe,{className:"w-8 h-8 text-black drop-shadow"}),e.jsx("h2",{className:"text-3xl font-extrabold text-black tracking-tight",children:"Content Enhancement"})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-base font-semibold text-black mb-3 flex items-center gap-2",children:[e.jsx(fe,{className:"w-5 h-5 text-black"}),"Paste your content or enter a URL"]}),e.jsxs("div",{className:"relative",children:[e.jsx("textarea",{ref:S,value:U,onChange:o=>{b(o.target.value);const y=o.target;y.style.height="auto";const p=Math.max(36,Math.min(y.scrollHeight,150));y.style.height=p+"px"},placeholder:"Paste URL or content here...",rows:1,className:"w-full bg-white border border-gray-300 rounded-lg px-4 py-2 pr-12 text-black text-base placeholder-black focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200 resize-none scrollbar-hide",style:{minHeight:"36px",maxHeight:"150px",height:"auto",overflow:"auto",scrollbarWidth:"none",msOverflowStyle:"none"}}),e.jsxs("div",{className:"absolute right-3 bottom-3",children:[e.jsx("input",{type:"file",id:"file-upload",accept:".txt,.md,.doc,.docx",onChange:o=>{const y=o.target.files?.[0];if(y){const p=new FileReader;p.onload=O=>{const C=O.target?.result;b(C),setTimeout(()=>{if(S.current){S.current.style.height="auto";const z=Math.max(36,Math.min(S.current.scrollHeight,150));S.current.style.height=z+"px"}},100)},p.readAsText(y)}},className:"hidden"}),e.jsx("label",{htmlFor:"file-upload",className:"cursor-pointer p-1.5 rounded-full transition-all duration-200 flex items-center justify-center bg-gray-100 hover:bg-gray-200 text-gray-600 hover:text-gray-800",title:"Upload file (.txt, .md, .doc, .docx)",children:e.jsx(ht,{className:"w-4 h-4"})})]})]})]}),e.jsx("div",{className:"flex items-center gap-4",children:a?e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-black",children:"Provider:"}),e.jsxs("select",{value:D,onChange:o=>F(o.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"gemini",children:"Gemini"}),e.jsx("option",{value:"openai",children:"ChatGPT"}),e.jsx("option",{value:"perplexity",children:"Perplexity"})]})]}),e.jsx("button",{type:"button",onClick:we,disabled:h||!U.trim(),className:"bg-blue-600 text-white font-bold px-8 py-3 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 text-lg shadow",children:h?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-5 h-5 animate-spin"}),"Generating Questions..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Generate AI Questions"]})})]}):e.jsx("div",{className:"flex items-center gap-2 p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("span",{className:"text-yellow-800",children:"⚠️ Please log in to generate questions"})})})]}),_&&l.length>0&&e.jsxs("div",{className:"card mt-8 p-6 bg-white border border-blue-600/10 shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("div",{className:"flex items-center gap-6",children:e.jsx("div",{children:e.jsx("h3",{className:"text-2xl font-bold text-black",children:"Generated Questions"})})}),e.jsx("div",{className:"text-sm text-black",children:"Select questions to generate answers"})]}),e.jsx("div",{className:"space-y-4 mb-6",children:l.map((o,y)=>e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg border border-gray-200",children:e.jsxs("div",{className:"flex items-start gap-3 mb-3",children:[e.jsx("input",{type:"checkbox",checked:f.has(y),onChange:()=>Ve(y),className:"mt-1 w-4 h-4 text-black bg-gray-100 border-gray-300 rounded focus:ring-blue-500 focus:ring-2"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"font-semibold text-black text-base",children:[y+1,". ",o]}),n.find(p=>p.question===o)&&e.jsxs("div",{className:"mt-3 p-3 bg-white rounded border border-gray-200 relative",children:[e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1",children:[e.jsx("button",{onClick:()=>Ge(o,n.find(p=>p.question===o)?.answer||""),className:"p-1.5 bg-white border border-gray-300 rounded-lg text-black hover:bg-gray-50 transition-colors",title:"Copy question and answer",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})})}),e.jsx("button",{onClick:()=>Ke(o),className:"p-1.5 bg-white border border-gray-300 rounded-lg text-black hover:bg-gray-50 transition-colors",title:"Generate new answer",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})})]}),e.jsx("div",{className:"text-sm text-black mb-1 font-medium",children:"Answer:"}),e.jsx("div",{className:"text-black text-sm leading-relaxed pr-16",children:n.find(p=>p.question===o)?.answer})]})]})]})},y))}),e.jsxs("div",{className:"flex items-center gap-4 justify-start",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("label",{className:"text-sm font-medium text-black",children:"Provider:"}),e.jsxs("select",{value:D,onChange:o=>F(o.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 bg-white",children:[e.jsx("option",{value:"gemini",children:"Gemini"}),e.jsx("option",{value:"openai",children:"ChatGPT"}),e.jsx("option",{value:"perplexity",children:"Perplexity"})]})]}),e.jsx("button",{onClick:Be,disabled:$||f.size===0,className:"bg-blue-600 text-white font-medium px-6 py-3 rounded-lg hover:bg-blue-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow text-base",children:$?e.jsxs(e.Fragment,{children:[e.jsx(re,{className:"w-5 h-5 animate-spin"}),"Generating Answers..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"})}),"Generate Answers"]})})]})]})]})}),e.jsxs("div",{className:"w-80 space-y-6",children:[e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:e.jsxs("button",{onClick:()=>{if(b(""),m([]),g([]),k(new Set),B(!1),V(!1),r(null),A(!1),E(!1),G(null),a?.id){const o=w(je,a.id),y=w("pending_faq_generation",a.id),p=w("generated_faqs",a.id);localStorage.removeItem(o),localStorage.removeItem(y),localStorage.removeItem(p)}S.current&&(S.current.style.height="36px")},className:"w-full bg-white text-black font-bold px-3 py-2 rounded-lg hover:bg-gray-50 transition-all duration-200 flex items-center gap-2 justify-start border border-blue-600 text-sm",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"New Analysis"]})}),e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("svg",{className:"w-5 h-5 text-black",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h3",{className:"text-lg font-semibold text-black",children:"History"})]}),e.jsxs("div",{className:"space-y-3 max-h-96 overflow-y-auto scrollbar-hide",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[t.slice(0,10).map((o,y)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg border border-gray-200 hover:border-gray-300 transition-all duration-200",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[o.type==="faq"?e.jsx("svg",{className:"w-4 h-4 text-black flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}):e.jsx("svg",{className:"w-4 h-4 text-gray-500 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.828 10.172a4 4 0 00-5.656 0l-4 4a4 4 0 105.656 5.656l1.102-1.101m-.758-4.899a4 4 0 005.656 0l4-4a4 4 0 00-5.656-5.656l-1.1 1.1"})}),e.jsx("div",{className:"text-sm font-medium text-black truncate",children:o.name})]}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(o.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("button",{onClick:()=>{const p=new Set(R);p.has(o.id)?p.delete(o.id):p.add(o.id),q(p)},className:"p-2 bg-white border border-gray-300 rounded-lg text-gray-600 hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:R.has(o.id)?"Collapse":"Expand",children:R.has(o.id)?e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"})}):e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})})]}),R.has(o.id)&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:o.type==="faq"?e.jsxs("div",{className:"space-y-3",children:[o.blogUrl&&e.jsxs("div",{className:"text-xs text-black bg-gray-50 p-2 rounded border border-gray-200",children:[e.jsx("strong",{children:"Source URL:"})," ",o.blogUrl]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Generated FAQs:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{b(o.blogContent||""),F(o.questionProvider||"gemini"),x(o.questionModel||(o.questionProvider==="perplexity"?"sonar":"gemini-1.5-flash")),we()},className:"p-2 bg-white border border-gray-300 rounded-lg text-black hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:"Regenerate FAQs",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("button",{onClick:()=>{const p=o.qaData?.map(ne=>({question:ne.question,answer:ne.answer}))||[],O=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),C=URL.createObjectURL(O),z=document.createElement("a");z.href=C,z.download=`faqs-${o.name.replace(/\s+/g,"-")}.json`,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(C),P("FAQs downloaded successfully!")},className:"p-2 bg-white border border-gray-300 rounded-lg text-gray-600 hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:"Download FAQs as JSON",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("button",{onClick:()=>ke(o.id),className:"p-2 bg-white border border-gray-300 rounded-lg text-red-600 hover:text-red-800 hover:bg-red-50 transition-all duration-200",title:"Delete session",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),o.qaData?.map((p,O)=>e.jsxs("div",{className:"p-2 bg-white rounded border border-gray-200",children:[e.jsxs("div",{className:"font-medium text-sm text-black mb-1",children:["Q: ",p.question]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["A: ",p.answer]})]},O)),e.jsxs("div",{className:"text-xs text-gray-500",children:["Provider: ",o.questionProvider," | Model: ",o.questionModel]})]}):e.jsxs("div",{className:"space-y-3",children:[o.blogUrl&&e.jsxs("div",{className:"text-xs text-black bg-gray-50 p-2 rounded border border-gray-200",children:[e.jsx("strong",{children:"Source URL:"})," ",o.blogUrl]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-xs text-gray-600 font-medium",children:"Generated Q&A:"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{b(o.blogContent||""),F(o.questionProvider||"gemini"),x(o.questionModel||(o.questionProvider==="perplexity"?"sonar":"gemini-1.5-flash")),we()},className:"p-2 bg-white border border-gray-300 rounded-lg text-black hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:"Regenerate Q&A",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"})})}),e.jsx("button",{onClick:()=>{const p=o.qaData?.map(ne=>({question:ne.question,answer:ne.answer}))||[],O=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),C=URL.createObjectURL(O),z=document.createElement("a");z.href=C,z.download=`qa-${o.name.replace(/\s+/g,"-")}.json`,document.body.appendChild(z),z.click(),document.body.removeChild(z),URL.revokeObjectURL(C),P("Q&A data downloaded successfully!")},className:"p-2 bg-white border border-gray-300 rounded-lg text-gray-600 hover:text-gray-800 hover:bg-gray-50 transition-all duration-200",title:"Download Q&A as JSON",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})})}),e.jsx("button",{onClick:()=>ke(o.id),className:"p-2 bg-white border border-gray-300 rounded-lg text-red-600 hover:text-red-800 hover:bg-red-50 transition-all duration-200",title:"Delete session",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1 1v3M4 7h16"})})})]})]}),o.qaData?.slice(0,3).map((p,O)=>e.jsxs("div",{className:"p-2 bg-white rounded border border-gray-200",children:[e.jsxs("div",{className:"font-medium text-sm text-black mb-1",children:["Q: ",p.question]}),e.jsxs("div",{className:"text-xs text-gray-600",children:["A: ",p.answer]})]},O)),o.qaData&&o.qaData.length>3&&e.jsxs("div",{className:"text-xs text-gray-500",children:["+",o.qaData.length-3," more questions"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Provider: ",o.questionProvider," | Model: ",o.questionModel]})]})})]},o.id)),t.length===0&&e.jsx("div",{className:"text-center text-gray-500 text-sm py-4",children:"No analysis history yet"})]})]})]}),e.jsx(qe,{message:M,onClose:()=>P(null),autoClose:!0,autoCloseDelay:3e3})]})}const $t="llm_qa_sessions",Ft="llm_qa_current_session",It="llm_competitor_urls",Tt=[{label:"Dashboard",icon:e.jsx(Ne,{}),path:"/overview"},{label:"Competitor Insight",icon:e.jsx(le,{}),path:"/ai-visibility-analysis"},{label:"Content Enhancement",icon:e.jsx(fe,{}),path:"/enhance-content"},{label:"Structure Analysis",icon:e.jsx(Me,{}),path:"/content-structure-analysis"},{label:"History",icon:e.jsx(Oe,{}),path:"/history"},{label:"Statistics",icon:e.jsx(xt,{}),path:"/statistics"}];function qt({isOpen:a,setIsOpen:n,onLogout:m,user:l,currentPath:g}){const f=ie(),k=h=>{f(h),n(!1)};return e.jsxs(e.Fragment,{children:[a&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 md:hidden",onClick:()=>n(!1)}),e.jsxs("aside",{className:`fixed md:static inset-y-0 left-0 z-50 bg-white w-64 min-h-screen flex flex-col border-r border-gray-200 shadow-lg transform transition-transform duration-300 md:transform-none sidebar-responsive ${a?"translate-x-0":"-translate-x-full"}`,children:[e.jsxs("div",{className:"flex items-center justify-between p-3 border-b border-primary/10 header-responsive",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0 logo-container",children:[e.jsx("div",{className:"w-8 h-8 bg-gradient-to-r from-primary to-accent rounded-lg flex items-center justify-center flex-shrink-0 logo-icon",children:e.jsx(Ne,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"text-lg font-bold text-primary tracking-wide truncate logo-text",children:"kabini.ai"})]}),e.jsx("button",{className:"md:hidden text-gray-500 hover:text-gray-700 hover:bg-gray-100 transition-colors p-1.5 rounded-md flex items-center justify-center flex-shrink-0 ml-2",onClick:()=>n(!1),"aria-label":"Close menu",children:e.jsxs("div",{className:"relative w-5 h-5 flex items-center justify-center",children:[e.jsx("div",{className:"absolute w-4 h-0.5 bg-gray-600 rounded-full transform rotate-45"}),e.jsx("div",{className:"absolute w-4 h-0.5 bg-gray-600 rounded-full transform -rotate-45"})]})})]}),e.jsx("nav",{className:"flex-1 flex flex-col gap-1 mt-4 px-2 nav-responsive",children:Tt.map(h=>{const A=g===h.path;return e.jsxs("button",{className:`nav-item-responsive ${A?"active":""}`,onClick:()=>k(h.path),children:[h.icon,h.label]},h.path)})}),e.jsxs("div",{className:"mt-auto user-profile-section",children:[e.jsxs("div",{className:"user-profile-info",children:[e.jsx("div",{className:"user-avatar",children:e.jsx(ce,{})}),e.jsxs("div",{className:"user-details",children:[e.jsx("div",{className:"user-name",children:l?.displayName||l?.name||"User"}),e.jsx("div",{className:"user-email",children:l?.email||""})]})]}),e.jsxs("button",{className:"logout-button",onClick:m,children:[e.jsx(Ue,{}),"Logout"]})]})]})]})}function Rt({setIsOpen:a,onLogout:n}){return e.jsxs("header",{className:"w-full bg-white border-b border-primary/10 flex items-center justify-between px-3 sm:px-6 py-3 relative z-30 header-responsive",children:[e.jsxs("div",{className:"logo-container",children:[e.jsx("div",{className:"logo-icon bg-gradient-to-r from-primary to-accent rounded-lg",children:e.jsx(Ne,{className:"w-5 h-5 text-white"})}),e.jsx("span",{className:"logo-text text-xl font-extrabold tracking-wide",children:"kabini.ai"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{className:"md:hidden bg-black border border-black text-white px-2 py-1.5 rounded-lg text-sm font-medium hover:bg-gray-800 hover:border-gray-800 transition-all flex items-center gap-2",onClick:n,"aria-label":"Logout",children:[e.jsx(Ue,{className:"w-4 h-4"}),e.jsx("span",{className:"hidden sm:inline",children:"Logout"})]}),e.jsx("button",{className:"block md:hidden text-primary hover:text-accent transition-colors p-2 rounded-lg hover:bg-gray-100 flex items-center justify-center border border-gray-200 bg-white",onClick:()=>a(!0),"aria-label":"Open menu",style:{minWidth:"44px",minHeight:"44px"},children:e.jsxs("div",{className:"relative w-6 h-6",children:[e.jsx("div",{className:"absolute w-5 h-1 bg-black rounded-full top-1 left-0.5"}),e.jsx("div",{className:"absolute w-5 h-1 bg-black rounded-full top-3 left-0.5"}),e.jsx("div",{className:"absolute w-5 h-1 bg-black rounded-full top-5 left-0.5"})]})})]})]})}function Ot(){return e.jsxs("footer",{className:"w-full bg-white border-t border-primary/10 text-center text-primary py-3 text-sm",children:["© ",new Date().getFullYear()," kabini.ai. All rights reserved."]})}function Te(){return e.jsx(Lt,{})}function Mt(){const{isAuthenticated:a,isLoading:n,logout:m,user:l,refreshUser:g}=be();console.log("[App] Authentication state:",{isAuthenticated:a,isLoading:n,hasUser:!!l,userEmail:l?.email}),u.useEffect(()=>{a&&!l&&!n&&(console.log("[App] Authenticated but no user data, forcing refresh..."),g())},[a,l,n,g]),u.useEffect(()=>{a&&l&&(console.log("[App] Clearing stale localStorage data..."),["llm_qa_current_session","structure_last_saved","overview_market_analysis"].forEach(N=>{try{localStorage.getItem(N)&&(console.log(`[App] Clearing stale localStorage key: ${N}`),localStorage.removeItem(N))}catch(x){console.warn(`[App] Could not clear ${N}:`,x)}}))},[a,l]);const[f,k]=u.useState(!1),h=Re(),[A]=Ce($t,[]),[$]=Ce(Ft,null);let E=[];try{const F=JSON.parse(localStorage.getItem(It)||"[]");E=Array.from(new Set(F.map(N=>{try{return new URL(N).hostname.replace(/^www\./,"")}catch{return N}}))).filter(Boolean)}catch{}if(n)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-black via-gray-900 to-black",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-primary font-medium",children:"Loading kabini.ai..."}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Please wait while we verify your authentication..."})]})});if(a&&!l)return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-black via-gray-900 to-black",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-primary font-medium",children:"Loading user data..."}),e.jsx("p",{className:"text-gray-400 text-sm mt-2",children:"Please wait while we load your profile..."})]})});if(!a)return console.log("[App] User not authenticated, showing login page"),e.jsxs(Ae,{children:[e.jsx(W,{path:"/signup",element:e.jsx(At,{})}),e.jsx(W,{path:"/forgot-password",element:e.jsx(Et,{})}),e.jsx(W,{path:"/reset-password",element:e.jsx(Dt,{})}),e.jsx(W,{path:"/test-notifications",element:e.jsx(Pt,{})}),e.jsx(W,{path:"*",element:e.jsx(vt,{})})]});console.log("[App] User is authenticated, showing main app");const D=async()=>{try{await m()}catch(F){console.error("Logout error:",F)}};return e.jsxs("div",{className:"flex min-h-screen bg-white overflow-hidden",children:[e.jsx(qt,{isOpen:f,setIsOpen:k,onLogout:D,user:l,currentPath:h.pathname}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-screen overflow-hidden content-responsive",children:[e.jsx(Rt,{setIsOpen:k,onLogout:D}),e.jsx("main",{className:"flex-1 p-responsive-md overflow-x-hidden overflow-y-auto text-black bg-white main-content-responsive",children:e.jsx("div",{className:"main-content-container",children:e.jsxs(Ae,{children:[e.jsx(W,{path:"/overview",element:e.jsx(Ye,{})}),e.jsx(W,{path:"/ai-visibility-analysis",element:e.jsx(Xe,{})}),e.jsx(W,{path:"/qa-generation",element:e.jsx(Te,{})}),e.jsx(W,{path:"/enhance-content",element:e.jsx(Te,{})}),e.jsx(W,{path:"/content-structure-analysis",element:e.jsx(kt,{})}),e.jsx(W,{path:"/history",element:e.jsx(Nt,{qaItems:A.flatMap(F=>F.qaData),onExport:jt})}),e.jsx(W,{path:"/statistics",element:e.jsx(et,{sessions:A,currentSession:$})}),e.jsx(W,{path:"/CloudFuzeLLMQA",element:e.jsx(Ee,{to:"/overview",replace:!0})}),e.jsx(W,{path:"/",element:e.jsx(Ee,{to:"/overview",replace:!0})})]})})}),e.jsx(Ot,{})]})]})}function Ut(){return e.jsx(rt,{children:e.jsx(Mt,{})})}ft.createRoot(document.getElementById("root")).render(e.jsx(u.StrictMode,{children:e.jsx(tt,{children:e.jsx(Ut,{})})}));
